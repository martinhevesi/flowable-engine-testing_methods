<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HistoricCaseInstanceQueryImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jacoco.exec</a> &gt; <a href="index.source.html" class="el_package">org.flowable.cmmn.engine.impl.history</a> &gt; <span class="el_source">HistoricCaseInstanceQueryImpl.java</span></div><h1>HistoricCaseInstanceQueryImpl.java</h1><pre class="source lang-java linenums">/* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.flowable.cmmn.engine.impl.history;

import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Objects;
import java.util.Set;

import org.flowable.cmmn.api.history.HistoricCaseInstance;
import org.flowable.cmmn.api.history.HistoricCaseInstanceQuery;
import org.flowable.cmmn.engine.CmmnEngineConfiguration;
import org.flowable.cmmn.engine.impl.IdentityLinkQueryObject;
import org.flowable.cmmn.engine.impl.cmd.DeleteHistoricCaseInstancesCmd;
import org.flowable.cmmn.engine.impl.cmd.DeleteRelatedDataOfRemovedHistoricCaseInstancesCmd;
import org.flowable.cmmn.engine.impl.cmd.DeleteTaskAndPlanItemInstanceDataOfRemovedHistoricCaseInstancesCmd;
import org.flowable.cmmn.engine.impl.delete.DeleteHistoricCaseInstancesUsingBatchesCmd;
import org.flowable.cmmn.engine.impl.persistence.entity.HistoricCaseInstanceEntity;
import org.flowable.common.engine.api.FlowableException;
import org.flowable.common.engine.api.FlowableIllegalArgumentException;
import org.flowable.common.engine.api.query.CacheAwareQuery;
import org.flowable.common.engine.api.scope.ScopeTypes;
import org.flowable.common.engine.impl.AbstractEngineConfiguration;
import org.flowable.common.engine.impl.context.Context;
import org.flowable.common.engine.impl.interceptor.CommandConfig;
import org.flowable.common.engine.impl.interceptor.CommandContext;
import org.flowable.common.engine.impl.interceptor.CommandExecutor;
import org.flowable.common.engine.impl.persistence.cache.EntityCache;
import org.flowable.variable.service.impl.AbstractVariableQueryImpl;
import org.flowable.variable.service.impl.persistence.entity.HistoricVariableInstanceEntity;

/**
 * @author Joram Barrez
 * @author Tijs Rademakers
 */
public class HistoricCaseInstanceQueryImpl extends AbstractVariableQueryImpl&lt;HistoricCaseInstanceQuery, HistoricCaseInstance&gt; 
        implements HistoricCaseInstanceQuery, CacheAwareQuery&lt;HistoricCaseInstanceEntity&gt; {

    private static final long serialVersionUID = 1L;
    
    protected CmmnEngineConfiguration cmmnEngineConfiguration;
    
    protected String caseDefinitionId;
    protected String caseDefinitionKey;
    protected Set&lt;String&gt; caseDefinitionKeys;
    protected Set&lt;String&gt; caseDefinitionIds;
    protected String caseDefinitionName;
    protected String caseDefinitionCategory;
    protected Integer caseDefinitionVersion;
    protected String caseInstanceId;
    protected Set&lt;String&gt; caseInstanceIds;
    protected String caseInstanceName;
    protected String caseInstanceNameLike;
    protected String caseInstanceNameLikeIgnoreCase;
    protected String rootScopeId;
    protected String parentScopeId;
    protected String businessKey;
    protected String businessStatus;
    protected String caseInstanceParentId;
    protected boolean withoutCaseInstanceParentId;
    protected String deploymentId;
    protected List&lt;String&gt; deploymentIds;
    protected boolean finished;
    protected boolean unfinished;
    protected Date startedBefore;
    protected Date startedAfter;
    protected Date finishedBefore;
    protected Date finishedAfter;
    protected String startedBy;
    protected String state;
    protected Date lastReactivatedBefore;
    protected Date lastReactivatedAfter;
    protected String lastReactivatedBy;
    protected String callbackId;
    protected String callbackType;
    protected boolean withoutCallbackId;
    protected String referenceId;
    protected String referenceType;
    protected String tenantId;
    protected boolean withoutTenantId;
    protected boolean includeCaseVariables;
    protected String activePlanItemDefinitionId;
    protected Set&lt;String&gt; activePlanItemDefinitionIds;
    protected String involvedUser;
    protected IdentityLinkQueryObject involvedUserIdentityLink;
    protected Set&lt;String&gt; involvedGroups;
    private List&lt;List&lt;String&gt;&gt; safeInvolvedGroups;
    protected IdentityLinkQueryObject involvedGroupIdentityLink;
<span class="nc" id="L100">    protected List&lt;HistoricCaseInstanceQueryImpl&gt; orQueryObjects = new ArrayList&lt;&gt;();</span>
    protected HistoricCaseInstanceQueryImpl currentOrQueryObject;
    protected boolean inOrStatement;
    protected String locale;
    protected boolean withLocalizationFallback;

<span class="nc" id="L106">    public HistoricCaseInstanceQueryImpl() {</span>
<span class="nc" id="L107">    }</span>

    public HistoricCaseInstanceQueryImpl(CommandContext commandContext, CmmnEngineConfiguration cmmnEngineConfiguration) {
<span class="nc" id="L110">        super(commandContext, cmmnEngineConfiguration.getVariableServiceConfiguration());</span>
<span class="nc" id="L111">        this.cmmnEngineConfiguration = cmmnEngineConfiguration;</span>
<span class="nc" id="L112">    }</span>

    public HistoricCaseInstanceQueryImpl(CommandExecutor commandExecutor, CmmnEngineConfiguration cmmnEngineConfiguration) {
<span class="nc" id="L115">        super(commandExecutor, cmmnEngineConfiguration.getVariableServiceConfiguration());</span>
<span class="nc" id="L116">        this.cmmnEngineConfiguration = cmmnEngineConfiguration;</span>
<span class="nc" id="L117">    }</span>

    @Override
    protected void ensureVariablesInitialized() {
<span class="nc" id="L121">        super.ensureVariablesInitialized();</span>

<span class="nc bnc" id="L123" title="All 2 branches missed.">        for (HistoricCaseInstanceQueryImpl orQueryObject : orQueryObjects) {</span>
<span class="nc" id="L124">            orQueryObject.ensureVariablesInitialized();</span>
<span class="nc" id="L125">        }</span>
<span class="nc" id="L126">    }</span>

    @Override
    public HistoricCaseInstanceQueryImpl caseDefinitionId(String caseDefinitionId) {
<span class="nc bnc" id="L130" title="All 2 branches missed.">        if (caseDefinitionId == null) {</span>
<span class="nc" id="L131">            throw new FlowableIllegalArgumentException(&quot;Case definition id is null&quot;);</span>
        }
<span class="nc bnc" id="L133" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L134">            this.currentOrQueryObject.caseDefinitionId = caseDefinitionId;</span>
        } else {
<span class="nc" id="L136">            this.caseDefinitionId = caseDefinitionId;</span>
        }
<span class="nc" id="L138">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery caseDefinitionIds(Set&lt;String&gt; caseDefinitionIds) {
<span class="nc bnc" id="L143" title="All 2 branches missed.">        if (caseDefinitionIds == null) {</span>
<span class="nc" id="L144">            throw new FlowableIllegalArgumentException(&quot;Case definition ids is null&quot;);</span>
        }
<span class="nc bnc" id="L146" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L147">            this.currentOrQueryObject.caseDefinitionIds = caseDefinitionIds;</span>
        } else {
<span class="nc" id="L149">            this.caseDefinitionIds = caseDefinitionIds;</span>
        }
<span class="nc" id="L151">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseDefinitionKey(String caseDefinitionKey) {
<span class="nc bnc" id="L156" title="All 2 branches missed.">        if (caseDefinitionKey == null) {</span>
<span class="nc" id="L157">            throw new FlowableIllegalArgumentException(&quot;Case definition key is null&quot;);</span>
        }
<span class="nc bnc" id="L159" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L160">            this.currentOrQueryObject.caseDefinitionKey = caseDefinitionKey;</span>
        } else {
<span class="nc" id="L162">            this.caseDefinitionKey = caseDefinitionKey;</span>
        }
<span class="nc" id="L164">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseDefinitionCategory(String caseDefinitionCategory) {
<span class="nc bnc" id="L169" title="All 2 branches missed.">        if (caseDefinitionCategory == null) {</span>
<span class="nc" id="L170">            throw new FlowableIllegalArgumentException(&quot;Case definition category is null&quot;);</span>
        }
<span class="nc bnc" id="L172" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L173">            this.currentOrQueryObject.caseDefinitionCategory= caseDefinitionCategory;</span>
        } else {
<span class="nc" id="L175">            this.caseDefinitionCategory = caseDefinitionCategory;</span>
        }
<span class="nc" id="L177">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseDefinitionName(String caseDefinitionName) {
<span class="nc bnc" id="L182" title="All 2 branches missed.">        if (caseDefinitionName == null) {</span>
<span class="nc" id="L183">            throw new FlowableIllegalArgumentException(&quot;Case definition name is null&quot;);</span>
        }
<span class="nc bnc" id="L185" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L186">            this.currentOrQueryObject.caseDefinitionName = caseDefinitionName;</span>
        } else {
<span class="nc" id="L188">            this.caseDefinitionName = caseDefinitionName;</span>
        }
<span class="nc" id="L190">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseDefinitionVersion(Integer caseDefinitionVersion) {
<span class="nc bnc" id="L195" title="All 2 branches missed.">        if (caseDefinitionVersion == null) {</span>
<span class="nc" id="L196">            throw new FlowableIllegalArgumentException(&quot;Case definition version is null&quot;);</span>
        }
<span class="nc bnc" id="L198" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L199">            this.currentOrQueryObject.caseDefinitionVersion = caseDefinitionVersion;</span>
        } else {
<span class="nc" id="L201">            this.caseDefinitionVersion = caseDefinitionVersion;</span>
        }
<span class="nc" id="L203">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceId(String caseInstanceId) {
<span class="nc bnc" id="L208" title="All 2 branches missed.">        if (caseInstanceId == null) {</span>
<span class="nc" id="L209">            throw new FlowableIllegalArgumentException(&quot;Case instance id is null&quot;);</span>
        }
<span class="nc bnc" id="L211" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L212">            this.currentOrQueryObject.caseInstanceId = caseInstanceId;</span>
        } else {
<span class="nc" id="L214">            this.caseInstanceId = caseInstanceId;</span>
        }
<span class="nc" id="L216">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceIds(Set&lt;String&gt; caseInstanceIds) {
<span class="nc bnc" id="L221" title="All 2 branches missed.">        if (caseInstanceIds == null) {</span>
<span class="nc" id="L222">            throw new FlowableIllegalArgumentException(&quot;Case instance ids is null&quot;);</span>
        }
<span class="nc bnc" id="L224" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L225">            this.currentOrQueryObject.caseInstanceIds = caseInstanceIds;</span>
        } else {
<span class="nc" id="L227">            this.caseInstanceIds = caseInstanceIds;</span>
        }
<span class="nc" id="L229">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceName(String name) {
<span class="nc bnc" id="L234" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L235">            this.currentOrQueryObject.caseInstanceName = name;</span>
        } else {
<span class="nc" id="L237">            this.caseInstanceName = name;</span>
        }
<span class="nc" id="L239">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceNameLike(String nameLike) {
<span class="nc bnc" id="L244" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L245">            this.currentOrQueryObject.caseInstanceNameLike = nameLike;</span>
        } else {
<span class="nc" id="L247">            this.caseInstanceNameLike = nameLike;</span>
        }
<span class="nc" id="L249">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceNameLikeIgnoreCase(String nameLikeIgnoreCase) {
<span class="nc bnc" id="L254" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L255">            this.currentOrQueryObject.caseInstanceNameLikeIgnoreCase = nameLikeIgnoreCase;</span>
        } else {
<span class="nc" id="L257">            this.caseInstanceNameLikeIgnoreCase = nameLikeIgnoreCase;</span>
        }
<span class="nc" id="L259">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceBusinessKey(String businessKey) {
<span class="nc bnc" id="L264" title="All 2 branches missed.">        if (businessKey == null) {</span>
<span class="nc" id="L265">            throw new FlowableIllegalArgumentException(&quot;Business key is null&quot;);</span>
        }
<span class="nc bnc" id="L267" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L268">            this.currentOrQueryObject.businessKey = businessKey;</span>
        } else {
<span class="nc" id="L270">            this.businessKey = businessKey;</span>
        }
<span class="nc" id="L272">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceRootScopeId(String rootScopeId) {
<span class="nc bnc" id="L277" title="All 2 branches missed.">        if (rootScopeId == null) {</span>
<span class="nc" id="L278">            throw new FlowableIllegalArgumentException(&quot;rootScopeId is null&quot;);</span>
        }
<span class="nc bnc" id="L280" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L281">            this.currentOrQueryObject.rootScopeId = rootScopeId;</span>
        } else {
<span class="nc" id="L283">            this.rootScopeId = rootScopeId;</span>
        }
<span class="nc" id="L285">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceParentScopeId(String parentScopeId) {
<span class="nc bnc" id="L290" title="All 2 branches missed.">        if (parentScopeId == null) {</span>
<span class="nc" id="L291">            throw new FlowableIllegalArgumentException(&quot;parentScopeId is null&quot;);</span>
        }
<span class="nc bnc" id="L293" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L294">            this.currentOrQueryObject.parentScopeId = parentScopeId;</span>
        } else {
<span class="nc" id="L296">            this.parentScopeId = parentScopeId;</span>
        }
<span class="nc" id="L298">        return this;</span>
    }


    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceBusinessStatus(String businessStatus) {
<span class="nc bnc" id="L304" title="All 2 branches missed.">        if (businessStatus == null) {</span>
<span class="nc" id="L305">            throw new FlowableIllegalArgumentException(&quot;Business status is null&quot;);</span>
        }
<span class="nc bnc" id="L307" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L308">            this.currentOrQueryObject.businessStatus = businessStatus;</span>
        } else {
<span class="nc" id="L310">            this.businessStatus = businessStatus;</span>
        }
<span class="nc" id="L312">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseDefinitionKeys(Set&lt;String&gt; caseDefinitionKeys) {
<span class="nc bnc" id="L317" title="All 2 branches missed.">        if (caseDefinitionKeys == null) {</span>
<span class="nc" id="L318">            throw new FlowableIllegalArgumentException(&quot;Case definition keys is null&quot;);</span>
        }
<span class="nc bnc" id="L320" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L321">            this.currentOrQueryObject.caseDefinitionKeys = caseDefinitionKeys;</span>
        } else {
<span class="nc" id="L323">            this.caseDefinitionKeys = caseDefinitionKeys;</span>
        }
<span class="nc" id="L325">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceParentId(String parentId) {
<span class="nc bnc" id="L330" title="All 2 branches missed.">        if (parentId == null) {</span>
<span class="nc" id="L331">            throw new FlowableIllegalArgumentException(&quot;Parent id is null&quot;);</span>
        }
<span class="nc bnc" id="L333" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L334">            this.currentOrQueryObject.caseInstanceParentId = parentId;</span>
        } else {
<span class="nc" id="L336">            this.caseInstanceParentId = parentId;</span>
        }
<span class="nc" id="L338">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQuery withoutCaseInstanceParent() {
<span class="nc bnc" id="L343" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L344">            this.currentOrQueryObject.withoutCaseInstanceParentId = true;</span>
        } else {
<span class="nc" id="L346">            this.withoutCaseInstanceParentId = true;</span>
        }
<span class="nc" id="L348">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl deploymentId(String deploymentId) {
<span class="nc bnc" id="L353" title="All 2 branches missed.">        if (deploymentId == null) {</span>
<span class="nc" id="L354">            throw new FlowableIllegalArgumentException(&quot;Deployment id is null&quot;);</span>
        }
<span class="nc bnc" id="L356" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L357">            this.currentOrQueryObject.deploymentId = deploymentId;</span>
        } else {
<span class="nc" id="L359">            this.deploymentId = deploymentId;</span>
        }
<span class="nc" id="L361">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl deploymentIds(List&lt;String&gt; deploymentIds) {
<span class="nc bnc" id="L366" title="All 2 branches missed.">        if (deploymentIds == null) {</span>
<span class="nc" id="L367">            throw new FlowableIllegalArgumentException(&quot;Deployment ids is null&quot;);</span>
        }
<span class="nc bnc" id="L369" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L370">            this.currentOrQueryObject.deploymentIds = deploymentIds;</span>
        } else {
<span class="nc" id="L372">            this.deploymentIds = deploymentIds;</span>
        }
<span class="nc" id="L374">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl finished() {
<span class="nc bnc" id="L379" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L380">            this.currentOrQueryObject.finished = true;</span>
        } else {
<span class="nc" id="L382">            this.finished = true;</span>
        }
<span class="nc" id="L384">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl unfinished() {
<span class="nc bnc" id="L389" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L390">            this.currentOrQueryObject.unfinished = true;</span>
        } else {
<span class="nc" id="L392">            this.unfinished = true;</span>
        }
<span class="nc" id="L394">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl finishedBefore(Date beforeTime) {
<span class="nc bnc" id="L399" title="All 2 branches missed.">        if (beforeTime == null) {</span>
<span class="nc" id="L400">            throw new FlowableIllegalArgumentException(&quot;before time is null&quot;);</span>
        }
<span class="nc bnc" id="L402" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L403">            this.currentOrQueryObject.finishedBefore = beforeTime;</span>
        } else {
<span class="nc" id="L405">            this.finishedBefore = beforeTime;</span>
        }
<span class="nc" id="L407">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl finishedAfter(Date afterTime) {
<span class="nc bnc" id="L412" title="All 2 branches missed.">        if (afterTime == null) {</span>
<span class="nc" id="L413">            throw new FlowableIllegalArgumentException(&quot;after time is null&quot;);</span>
        }
<span class="nc bnc" id="L415" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L416">            this.currentOrQueryObject.finishedAfter = afterTime;</span>
        } else {
<span class="nc" id="L418">            this.finishedAfter = afterTime;</span>
        }
<span class="nc" id="L420">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl startedBefore(Date beforeTime) {
<span class="nc bnc" id="L425" title="All 2 branches missed.">        if (beforeTime == null) {</span>
<span class="nc" id="L426">            throw new FlowableIllegalArgumentException(&quot;before time is null&quot;);</span>
        }
<span class="nc bnc" id="L428" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L429">            this.currentOrQueryObject.startedBefore = beforeTime;</span>
        } else {
<span class="nc" id="L431">            this.startedBefore = beforeTime;</span>
        }
<span class="nc" id="L433">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl startedAfter(Date afterTime) {
<span class="nc bnc" id="L438" title="All 2 branches missed.">        if (afterTime == null) {</span>
<span class="nc" id="L439">            throw new FlowableIllegalArgumentException(&quot;after time is null&quot;);</span>
        }
<span class="nc bnc" id="L441" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L442">            this.currentOrQueryObject.startedAfter = afterTime;</span>
        } else {
<span class="nc" id="L444">            this.startedAfter = afterTime;</span>
        }

<span class="nc" id="L447">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl startedBy(String userId) {
<span class="nc bnc" id="L452" title="All 2 branches missed.">        if (userId == null) {</span>
<span class="nc" id="L453">            throw new FlowableIllegalArgumentException(&quot;user id is null&quot;);</span>
        }
<span class="nc bnc" id="L455" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L456">            this.currentOrQueryObject.startedBy = userId;</span>
        } else {
<span class="nc" id="L458">            this.startedBy = userId;</span>
        }

<span class="nc" id="L461">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl state(String state) {
<span class="nc bnc" id="L466" title="All 2 branches missed.">        if (state == null) {</span>
<span class="nc" id="L467">            throw new FlowableIllegalArgumentException(&quot;state is null&quot;);</span>
        }
<span class="nc bnc" id="L469" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L470">            this.currentOrQueryObject.state = state;</span>
        } else {
<span class="nc" id="L472">            this.state = state;</span>
        }

<span class="nc" id="L475">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery lastReactivatedBefore(Date beforeTime) {
<span class="nc bnc" id="L480" title="All 2 branches missed.">        if (beforeTime == null) {</span>
<span class="nc" id="L481">            throw new FlowableIllegalArgumentException(&quot;before time is null&quot;);</span>
        }
<span class="nc bnc" id="L483" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L484">            this.currentOrQueryObject.lastReactivatedBefore = beforeTime;</span>
        } else {
<span class="nc" id="L486">            this.lastReactivatedBefore = beforeTime;</span>
        }
<span class="nc" id="L488">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery lastReactivatedAfter(Date afterTime) {
<span class="nc bnc" id="L493" title="All 2 branches missed.">        if (afterTime == null) {</span>
<span class="nc" id="L494">            throw new FlowableIllegalArgumentException(&quot;after time is null&quot;);</span>
        }
<span class="nc bnc" id="L496" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L497">            this.currentOrQueryObject.lastReactivatedAfter = afterTime;</span>
        } else {
<span class="nc" id="L499">            this.lastReactivatedAfter = afterTime;</span>
        }

<span class="nc" id="L502">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery lastReactivatedBy(String userId) {
<span class="nc bnc" id="L507" title="All 2 branches missed.">        if (userId == null) {</span>
<span class="nc" id="L508">            throw new FlowableIllegalArgumentException(&quot;user id is null&quot;);</span>
        }
<span class="nc bnc" id="L510" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L511">            this.currentOrQueryObject.lastReactivatedBy = userId;</span>
        } else {
<span class="nc" id="L513">            this.lastReactivatedBy = userId;</span>
        }

<span class="nc" id="L516">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery caseInstanceCallbackId(String callbackId) {
<span class="nc bnc" id="L521" title="All 2 branches missed.">        if (callbackId == null) {</span>
<span class="nc" id="L522">            throw new FlowableIllegalArgumentException(&quot;callback id is null&quot;);</span>
        }
<span class="nc bnc" id="L524" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L525">            this.currentOrQueryObject.callbackId = callbackId;</span>
        } else {
<span class="nc" id="L527">            this.callbackId = callbackId;</span>
        }
<span class="nc" id="L529">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQuery caseInstanceCallbackType(String callbackType) {
<span class="nc bnc" id="L534" title="All 2 branches missed.">        if (callbackType == null) {</span>
<span class="nc" id="L535">            throw new FlowableIllegalArgumentException(&quot;callback type is null&quot;);</span>
        }
<span class="nc bnc" id="L537" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L538">            this.currentOrQueryObject.callbackType = callbackType;</span>
        } else {
<span class="nc" id="L540">            this.callbackType = callbackType;</span>
        }
<span class="nc" id="L542">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery withoutCaseInstanceCallbackId() {
<span class="nc bnc" id="L547" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L548">            this.currentOrQueryObject.withoutCallbackId = true;</span>
        } else {
<span class="nc" id="L550">            this.withoutCallbackId = true;</span>
        }
<span class="nc" id="L552">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery caseInstanceReferenceId(String referenceId) {
<span class="nc bnc" id="L557" title="All 2 branches missed.">        if (referenceId == null) {</span>
<span class="nc" id="L558">            throw new FlowableIllegalArgumentException(&quot;referenceId is null&quot;);</span>
        }
<span class="nc bnc" id="L560" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L561">            this.currentOrQueryObject.referenceId = referenceId;</span>
        } else {
<span class="nc" id="L563">            this.referenceId = referenceId;</span>
        }
<span class="nc" id="L565">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery caseInstanceReferenceType(String referenceType) {
<span class="nc bnc" id="L570" title="All 2 branches missed.">        if (referenceType == null) {</span>
<span class="nc" id="L571">            throw new FlowableIllegalArgumentException(&quot;referenceType is null&quot;);</span>
        }
<span class="nc bnc" id="L573" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L574">            this.currentOrQueryObject.referenceType = referenceType;</span>
        } else {
<span class="nc" id="L576">            this.referenceType = referenceType;</span>
        }
<span class="nc" id="L578">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceTenantId(String tenantId) {
<span class="nc bnc" id="L583" title="All 2 branches missed.">        if (tenantId == null) {</span>
<span class="nc" id="L584">            throw new FlowableIllegalArgumentException(&quot;caseInstance tenant id is null&quot;);</span>
        }
<span class="nc bnc" id="L586" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L587">            this.currentOrQueryObject.tenantId = tenantId;</span>
        } else {
<span class="nc" id="L589">            this.tenantId = tenantId;</span>
        }
<span class="nc" id="L591">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl caseInstanceWithoutTenantId() {
<span class="nc bnc" id="L596" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L597">            this.currentOrQueryObject.withoutTenantId = true;</span>
        } else {
<span class="nc" id="L599">            this.withoutTenantId = true;</span>
        }
<span class="nc" id="L601">        return this;</span>
    }

    // ordering ////////////////////////////////////////////////////

    @Override
    public HistoricCaseInstanceQueryImpl orderByCaseInstanceId() {
<span class="nc" id="L608">        this.orderProperty = HistoricCaseInstanceQueryProperty.CASE_INSTANCE_ID;</span>
<span class="nc" id="L609">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl orderByCaseInstanceName() {
<span class="nc" id="L614">        this.orderProperty = HistoricCaseInstanceQueryProperty.CASE_INSTANCE_NAME;</span>
<span class="nc" id="L615">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl orderByCaseDefinitionId() {
<span class="nc" id="L620">        this.orderProperty = HistoricCaseInstanceQueryProperty.CASE_DEFINITION_ID;</span>
<span class="nc" id="L621">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl orderByCaseDefinitionKey() {
<span class="nc" id="L626">        this.orderProperty = HistoricCaseInstanceQueryProperty.CASE_DEFINITION_KEY;</span>
<span class="nc" id="L627">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl orderByStartTime() {
<span class="nc" id="L632">        this.orderProperty = HistoricCaseInstanceQueryProperty.CASE_START_TIME;</span>
<span class="nc" id="L633">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQueryImpl orderByEndTime() {
<span class="nc" id="L638">        this.orderProperty = HistoricCaseInstanceQueryProperty.CASE_END_TIME;</span>
<span class="nc" id="L639">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQueryImpl orderByTenantId() {
<span class="nc" id="L644">        this.orderProperty = HistoricCaseInstanceQueryProperty.TENANT_ID;</span>
<span class="nc" id="L645">        return this;</span>
    }

    // results ////////////////////////////////////////////////////

    @Override
    public long executeCount(CommandContext commandContext) {
<span class="nc" id="L652">        ensureVariablesInitialized();</span>
<span class="nc" id="L653">        return cmmnEngineConfiguration.getHistoricCaseInstanceEntityManager().countByCriteria(this);</span>
    }

    @Override
    public List&lt;HistoricCaseInstance&gt; executeList(CommandContext commandContext) {
<span class="nc" id="L658">        ensureVariablesInitialized();</span>
        List&lt;HistoricCaseInstance&gt; results;
<span class="nc bnc" id="L660" title="All 2 branches missed.">        if (includeCaseVariables) {</span>
<span class="nc" id="L661">            results = cmmnEngineConfiguration.getHistoricCaseInstanceEntityManager().findWithVariablesByQueryCriteria(this);</span>

<span class="nc bnc" id="L663" title="All 2 branches missed.">            if (caseInstanceId != null) {</span>
<span class="nc" id="L664">                addCachedVariableForQueryById(commandContext, results);</span>
            }

        } else {
<span class="nc" id="L668">            results = cmmnEngineConfiguration.getHistoricCaseInstanceEntityManager().findByCriteria(this);</span>
        }

<span class="nc bnc" id="L671" title="All 2 branches missed.">        if (cmmnEngineConfiguration.getCaseLocalizationManager() != null) {</span>
<span class="nc bnc" id="L672" title="All 2 branches missed.">            for (HistoricCaseInstance historicCaseInstance : results) {</span>
<span class="nc" id="L673">                cmmnEngineConfiguration.getCaseLocalizationManager().localize(historicCaseInstance, locale, withLocalizationFallback);</span>
<span class="nc" id="L674">            }</span>
        }

<span class="nc" id="L677">        return results;</span>
    }

    protected void addCachedVariableForQueryById(CommandContext commandContext, List&lt;HistoricCaseInstance&gt; results) {

        // Unlike the CaseInstanceEntityImpl, variables are not stored on the HistoricCaseInstanceEntityImpl.
        // The solution for the non-historical entity is to use the variable cache on the entity, inspect the variables
        // of the current transaction and add them if necessary.
        // For the historical entity, we need to detect this use case specifically (i.e. byId is used) and check the entityCache.

<span class="nc bnc" id="L687" title="All 2 branches missed.">        for (HistoricCaseInstance historicCaseInstance : results) {</span>
<span class="nc bnc" id="L688" title="All 2 branches missed.">            if (Objects.equals(caseInstanceId, historicCaseInstance.getId())) {</span>

<span class="nc" id="L690">                EntityCache entityCache = commandContext.getSession(EntityCache.class);</span>
<span class="nc" id="L691">                List&lt;HistoricVariableInstanceEntity&gt; cachedVariableEntities = entityCache.findInCache(HistoricVariableInstanceEntity.class);</span>
<span class="nc bnc" id="L692" title="All 2 branches missed.">                for (HistoricVariableInstanceEntity cachedVariableEntity : cachedVariableEntities) {</span>

<span class="nc bnc" id="L694" title="All 2 branches missed.">                    if (historicCaseInstance.getId().equals(cachedVariableEntity.getScopeId())</span>
<span class="nc bnc" id="L695" title="All 2 branches missed.">                            &amp;&amp; ScopeTypes.CMMN.equals(cachedVariableEntity.getScopeType())) {</span>

                        // Variables from the cache have precedence
<span class="nc" id="L698">                        ((HistoricCaseInstanceEntity) historicCaseInstance).getQueryVariables().add(cachedVariableEntity);</span>

                    }

<span class="nc" id="L702">                }</span>

            }
<span class="nc" id="L705">        }</span>
<span class="nc" id="L706">    }</span>

    @Override
    public void enhanceCachedValue(HistoricCaseInstanceEntity caseInstance) {
<span class="nc bnc" id="L710" title="All 2 branches missed.">        if (isIncludeCaseVariables()) {</span>
<span class="nc" id="L711">            caseInstance.getQueryVariables()</span>
<span class="nc" id="L712">                    .addAll(cmmnEngineConfiguration.getVariableServiceConfiguration().getHistoricVariableInstanceEntityManager()</span>
<span class="nc" id="L713">                            .findHistoricalVariableInstancesByScopeIdAndScopeType(caseInstance.getId(), ScopeTypes.CMMN));</span>
        }
<span class="nc" id="L715">    }</span>

    @Override
    public void delete() {
<span class="nc bnc" id="L719" title="All 2 branches missed.">        if (commandExecutor != null) {</span>
<span class="nc" id="L720">            commandExecutor.execute(new DeleteHistoricCaseInstancesCmd(this));</span>
        } else {
<span class="nc" id="L722">            new DeleteHistoricCaseInstancesCmd(this).execute(Context.getCommandContext());</span>
        }
<span class="nc" id="L724">    }</span>

    @Override
    @Deprecated
    public void deleteWithRelatedData() {
<span class="nc bnc" id="L729" title="All 2 branches missed.">        if (commandExecutor != null) {</span>
<span class="nc" id="L730">            CommandConfig config = new CommandConfig().transactionRequiresNew();</span>
<span class="nc" id="L731">            commandExecutor.execute(config, new DeleteHistoricCaseInstancesCmd(this));</span>
<span class="nc" id="L732">            commandExecutor.execute(config, new DeleteTaskAndPlanItemInstanceDataOfRemovedHistoricCaseInstancesCmd());</span>
<span class="nc" id="L733">            commandExecutor.execute(config, new DeleteRelatedDataOfRemovedHistoricCaseInstancesCmd());</span>
<span class="nc" id="L734">        } else {</span>
<span class="nc" id="L735">            throw new FlowableException(&quot;deleting historic case instances with related data requires CommandExecutor&quot;);</span>
        }
<span class="nc" id="L737">    }</span>

    @Override
    public String deleteInParallelUsingBatch(int batchSize, String batchName) {
<span class="nc" id="L741">        return commandExecutor.execute(new DeleteHistoricCaseInstancesUsingBatchesCmd(this, batchSize, batchName, false));</span>
    }

    @Override
    public String deleteSequentiallyUsingBatch(int batchSize, String batchName) {
<span class="nc" id="L746">        return commandExecutor.execute(new DeleteHistoricCaseInstancesUsingBatchesCmd(this, batchSize, batchName, true));</span>
    }

    @Override
    public HistoricCaseInstanceQuery includeCaseVariables() {
<span class="nc" id="L751">        this.includeCaseVariables = true;</span>
<span class="nc" id="L752">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery activePlanItemDefinitionId(String planItemDefinitionId) {
<span class="nc bnc" id="L757" title="All 2 branches missed.">        if (planItemDefinitionId == null) {</span>
<span class="nc" id="L758">            throw new FlowableIllegalArgumentException(&quot;planItemDefinitionId is null&quot;);</span>
        }
<span class="nc bnc" id="L760" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L761">            this.currentOrQueryObject.activePlanItemDefinitionId = planItemDefinitionId;</span>
        } else {
<span class="nc" id="L763">            this.activePlanItemDefinitionId = planItemDefinitionId;</span>
        }
<span class="nc" id="L765">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQuery activePlanItemDefinitionIds(Set&lt;String&gt; planItemDefinitionIds) {
<span class="nc bnc" id="L770" title="All 2 branches missed.">        if (planItemDefinitionIds == null) {</span>
<span class="nc" id="L771">            throw new FlowableIllegalArgumentException(&quot;planItemDefinitionIds is null&quot;);</span>
        }
<span class="nc bnc" id="L773" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L774">            this.currentOrQueryObject.activePlanItemDefinitionIds = planItemDefinitionIds;</span>
        } else {
<span class="nc" id="L776">            this.activePlanItemDefinitionIds = planItemDefinitionIds;</span>
        }
<span class="nc" id="L778">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery involvedUser(String userId) {
<span class="nc bnc" id="L783" title="All 2 branches missed.">        if (userId == null) {</span>
<span class="nc" id="L784">            throw new FlowableIllegalArgumentException(&quot;involvedUser is null&quot;);</span>
        }
<span class="nc bnc" id="L786" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L787">            this.currentOrQueryObject.involvedUser = userId;</span>
        } else {
<span class="nc" id="L789">            this.involvedUser = userId;</span>
        }
<span class="nc" id="L791">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQuery involvedUser(String userId, String identityLinkType) {
<span class="nc bnc" id="L796" title="All 2 branches missed.">        if (userId == null) {</span>
<span class="nc" id="L797">            throw new FlowableIllegalArgumentException(&quot;userId is null&quot;);</span>
        }
<span class="nc bnc" id="L799" title="All 2 branches missed.">        if (identityLinkType == null) {</span>
<span class="nc" id="L800">            throw new FlowableIllegalArgumentException(&quot;identityLinkType is null&quot;);</span>
        }
<span class="nc bnc" id="L802" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L803">            this.currentOrQueryObject.involvedUserIdentityLink = new IdentityLinkQueryObject(userId, null, identityLinkType);</span>
        } else {
<span class="nc" id="L805">            this.involvedUserIdentityLink = new IdentityLinkQueryObject(userId, null, identityLinkType);</span>
        }
<span class="nc" id="L807">        return this;</span>
    }
    
    @Override
    public HistoricCaseInstanceQuery involvedGroup(String groupId, String identityLinkType) {
<span class="nc bnc" id="L812" title="All 2 branches missed.">        if (groupId == null) {</span>
<span class="nc" id="L813">            throw new FlowableIllegalArgumentException(&quot;groupId is null&quot;);</span>
        }
<span class="nc bnc" id="L815" title="All 2 branches missed.">        if (identityLinkType == null) {</span>
<span class="nc" id="L816">            throw new FlowableIllegalArgumentException(&quot;identityLinkType is null&quot;);</span>
        }
<span class="nc bnc" id="L818" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L819">            this.currentOrQueryObject.involvedGroupIdentityLink = new IdentityLinkQueryObject(null, groupId, identityLinkType);</span>
        } else {
<span class="nc" id="L821">            this.involvedGroupIdentityLink = new IdentityLinkQueryObject(null, groupId, identityLinkType);</span>
        }
<span class="nc" id="L823">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery involvedGroups(Set&lt;String&gt; groupIds) {
<span class="nc bnc" id="L828" title="All 2 branches missed.">        if (groupIds == null) {</span>
<span class="nc" id="L829">            throw new FlowableIllegalArgumentException(&quot;groupIds are null&quot;);</span>
        }
<span class="nc bnc" id="L831" title="All 2 branches missed.">        if (groupIds.isEmpty()) {</span>
<span class="nc" id="L832">            throw new FlowableIllegalArgumentException(&quot;groupIds are empty&quot;);</span>
        }
<span class="nc bnc" id="L834" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L835">            this.currentOrQueryObject.involvedGroups = groupIds;</span>
        } else {
<span class="nc" id="L837">            this.involvedGroups = groupIds;</span>
        }
<span class="nc" id="L839">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery or() {
<span class="nc bnc" id="L844" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L845">            throw new FlowableException(&quot;the query is already in an or statement&quot;);</span>
        }

<span class="nc" id="L848">        inOrStatement = true;</span>
<span class="nc bnc" id="L849" title="All 2 branches missed.">        if (commandContext != null) {</span>
<span class="nc" id="L850">            currentOrQueryObject = new HistoricCaseInstanceQueryImpl(commandContext, cmmnEngineConfiguration);</span>
        } else {
<span class="nc" id="L852">            currentOrQueryObject = new HistoricCaseInstanceQueryImpl(commandExecutor, cmmnEngineConfiguration);</span>
        }
<span class="nc" id="L854">        orQueryObjects.add(currentOrQueryObject);</span>
<span class="nc" id="L855">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery endOr() {
<span class="nc bnc" id="L860" title="All 2 branches missed.">        if (!inOrStatement) {</span>
<span class="nc" id="L861">            throw new FlowableException(&quot;endOr() can only be called after calling or()&quot;);</span>
        }

<span class="nc" id="L864">        inOrStatement = false;</span>
<span class="nc" id="L865">        currentOrQueryObject = null;</span>
<span class="nc" id="L866">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery variableValueEquals(String variableName, Object variableValue) {
<span class="nc bnc" id="L871" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L872">            currentOrQueryObject.variableValueEquals(variableName, variableValue, false);</span>
<span class="nc" id="L873">            return this;</span>
        } else {
<span class="nc" id="L875">            return variableValueEquals(variableName, variableValue, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueNotEquals(String variableName, Object variableValue) {
<span class="nc bnc" id="L881" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L882">            currentOrQueryObject.variableValueNotEquals(variableName, variableValue, false);</span>
<span class="nc" id="L883">            return this;</span>
        } else {
<span class="nc" id="L885">            return variableValueNotEquals(variableName, variableValue, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueEquals(Object variableValue) {
<span class="nc bnc" id="L891" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L892">            currentOrQueryObject.variableValueEquals(variableValue, false);</span>
<span class="nc" id="L893">            return this;</span>
        } else {
<span class="nc" id="L895">            return variableValueEquals(variableValue, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueEqualsIgnoreCase(String name, String value) {
<span class="nc bnc" id="L901" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L902">            currentOrQueryObject.variableValueEqualsIgnoreCase(name, value, false);</span>
<span class="nc" id="L903">            return this;</span>
        } else {
<span class="nc" id="L905">            return variableValueEqualsIgnoreCase(name, value, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueNotEqualsIgnoreCase(String name, String value) {
<span class="nc bnc" id="L911" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L912">            currentOrQueryObject.variableValueNotEqualsIgnoreCase(name, value, false);</span>
<span class="nc" id="L913">            return this;</span>
        } else {
<span class="nc" id="L915">            return variableValueNotEqualsIgnoreCase(name, value, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueLikeIgnoreCase(String name, String value) {
<span class="nc bnc" id="L921" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L922">            currentOrQueryObject.variableValueLikeIgnoreCase(name, value, false);</span>
<span class="nc" id="L923">            return this;</span>
        } else {
<span class="nc" id="L925">            return variableValueLikeIgnoreCase(name, value, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueGreaterThan(String name, Object value) {
<span class="nc bnc" id="L931" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L932">            currentOrQueryObject.variableValueGreaterThan(name, value, false);</span>
<span class="nc" id="L933">            return this;</span>
        } else {
<span class="nc" id="L935">            return variableValueGreaterThan(name, value, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueGreaterThanOrEqual(String name, Object value) {
<span class="nc bnc" id="L941" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L942">            currentOrQueryObject.variableValueGreaterThanOrEqual(name, value, false);</span>
<span class="nc" id="L943">            return this;</span>
        } else {
<span class="nc" id="L945">            return variableValueGreaterThanOrEqual(name, value, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueLessThan(String name, Object value) {
<span class="nc bnc" id="L951" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L952">            currentOrQueryObject.variableValueLessThan(name, value, false);</span>
<span class="nc" id="L953">            return this;</span>
        } else {
<span class="nc" id="L955">            return variableValueLessThan(name, value, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueLessThanOrEqual(String name, Object value) {
<span class="nc bnc" id="L961" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L962">            currentOrQueryObject.variableValueLessThanOrEqual(name, value, false);</span>
<span class="nc" id="L963">            return this;</span>
        } else {
<span class="nc" id="L965">            return variableValueLessThanOrEqual(name, value, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableValueLike(String name, String value) {
<span class="nc bnc" id="L971" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L972">            currentOrQueryObject.variableValueLike(name, value, false);</span>
<span class="nc" id="L973">            return this;</span>
        } else {
<span class="nc" id="L975">            return variableValueLike(name, value, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableExists(String name) {
<span class="nc bnc" id="L981" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L982">            currentOrQueryObject.variableExists(name, false);</span>
<span class="nc" id="L983">            return this;</span>
        } else {
<span class="nc" id="L985">            return variableExists(name, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery variableNotExists(String name) {
<span class="nc bnc" id="L991" title="All 2 branches missed.">        if (inOrStatement) {</span>
<span class="nc" id="L992">            currentOrQueryObject.variableNotExists(name, false);</span>
<span class="nc" id="L993">            return this;</span>
        } else {
<span class="nc" id="L995">            return variableNotExists(name, false);</span>
        }
    }

    @Override
    public HistoricCaseInstanceQuery locale(String locale) {
<span class="nc" id="L1001">        this.locale = locale;</span>
<span class="nc" id="L1002">        return this;</span>
    }

    @Override
    public HistoricCaseInstanceQuery withLocalizationFallback() {
<span class="nc" id="L1007">        this.withLocalizationFallback = true;</span>
<span class="nc" id="L1008">        return this;</span>
    }

    public String getCaseDefinitionId() {
<span class="nc" id="L1012">        return caseDefinitionId;</span>
    }

    public String getCaseDefinitionKey() {
<span class="nc" id="L1016">        return caseDefinitionKey;</span>
    }

    public Set&lt;String&gt; getCaseDefinitionKeys() {
<span class="nc" id="L1020">        return caseDefinitionKeys;</span>
    }

    public Set&lt;String&gt; getCaseDefinitionIds() {
<span class="nc" id="L1024">        return caseDefinitionIds;</span>
    }

    public String getCaseDefinitionName() {
<span class="nc" id="L1028">        return caseDefinitionName;</span>
    }

    public String getCaseDefinitionCategory() {
<span class="nc" id="L1032">        return caseDefinitionCategory;</span>
    }

    public Integer getCaseDefinitionVersion() {
<span class="nc" id="L1036">        return caseDefinitionVersion;</span>
    }

    public String getCaseInstanceId() {
<span class="nc" id="L1040">        return caseInstanceId;</span>
    }
    
    @Override
    public String getId() {
<span class="nc" id="L1045">        return caseInstanceId;</span>
    }

    public String getCaseInstanceName() {
<span class="nc" id="L1049">        return caseInstanceName;</span>
    }

    public String getCaseInstanceNameLike() {
<span class="nc" id="L1053">        return caseInstanceNameLike;</span>
    }

    public String getCaseInstanceNameLikeIgnoreCase() {
<span class="nc" id="L1057">        return caseInstanceNameLikeIgnoreCase;</span>
    }

    public String getBusinessKey() {
<span class="nc" id="L1061">        return businessKey;</span>
    }
    
    public String getBusinessStatus() {
<span class="nc" id="L1065">        return businessStatus;</span>
    }

    public String getCaseInstanceParentId() {
<span class="nc" id="L1069">        return caseInstanceParentId;</span>
    }

    public boolean isWithoutCaseInstanceParentId() {
<span class="nc" id="L1073">        return withoutCaseInstanceParentId;</span>
    }

    public boolean isFinished() {
<span class="nc" id="L1077">        return finished;</span>
    }

    public boolean isUnfinished() {
<span class="nc" id="L1081">        return unfinished;</span>
    }

    public Date getStartedBefore() {
<span class="nc" id="L1085">        return startedBefore;</span>
    }

    public Date getStartedAfter() {
<span class="nc" id="L1089">        return startedAfter;</span>
    }

    public Date getFinishedBefore() {
<span class="nc" id="L1093">        return finishedBefore;</span>
    }

    public Date getFinishedAfter() {
<span class="nc" id="L1097">        return finishedAfter;</span>
    }

    public String getStartedBy() {
<span class="nc" id="L1101">        return startedBy;</span>
    }
    
    public String getState() {
<span class="nc" id="L1105">        return state;</span>
    }

    public Date getLastReactivatedBefore() {
<span class="nc" id="L1109">        return lastReactivatedBefore;</span>
    }

    public Date getLastReactivatedAfter() {
<span class="nc" id="L1113">        return lastReactivatedAfter;</span>
    }

    public String getLastReactivatedBy() {
<span class="nc" id="L1117">        return lastReactivatedBy;</span>
    }

    public String getCallbackId() {
<span class="nc" id="L1121">        return callbackId;</span>
    }

    public String getCallbackType() {
<span class="nc" id="L1125">        return callbackType;</span>
    }

    public boolean isWithoutCallbackId() {
<span class="nc" id="L1129">        return withoutCallbackId;</span>
    }

    public String getReferenceId() {
<span class="nc" id="L1133">        return referenceId;</span>
    }

    public String getReferenceType() {
<span class="nc" id="L1137">        return referenceType;</span>
    }

    public String getTenantId() {
<span class="nc" id="L1141">        return tenantId;</span>
    }

    public boolean isWithoutTenantId() {
<span class="nc" id="L1145">        return withoutTenantId;</span>
    }

    public String getActivePlanItemDefinitionId() {
<span class="nc" id="L1149">        return activePlanItemDefinitionId;</span>
    }

    public Set&lt;String&gt; getActivePlanItemDefinitionIds() {
<span class="nc" id="L1153">        return activePlanItemDefinitionIds;</span>
    }

    public String getInvolvedUser() {
<span class="nc" id="L1157">        return involvedUser;</span>
    }

    public IdentityLinkQueryObject getInvolvedUserIdentityLink() {
<span class="nc" id="L1161">        return involvedUserIdentityLink;</span>
    }

    public Set&lt;String&gt; getInvolvedGroups() {
<span class="nc" id="L1165">        return involvedGroups;</span>
    }
    
    public IdentityLinkQueryObject getInvolvedGroupIdentityLink() {
<span class="nc" id="L1169">        return involvedGroupIdentityLink;</span>
    }

    public boolean isIncludeCaseVariables() {
<span class="nc" id="L1173">        return includeCaseVariables;</span>
    }

    public List&lt;HistoricCaseInstanceQueryImpl&gt; getOrQueryObjects() {
<span class="nc" id="L1177">        return orQueryObjects;</span>
    }

    public String getDeploymentId() {
<span class="nc" id="L1181">        return deploymentId;</span>
    }

    public List&lt;String&gt; getDeploymentIds() {
<span class="nc" id="L1185">        return deploymentIds;</span>
    }

    public Set&lt;String&gt; getCaseInstanceIds() {
<span class="nc" id="L1189">        return caseInstanceIds;</span>
    }

    public boolean isNeedsCaseDefinitionOuterJoin() {
<span class="nc bnc" id="L1193" title="All 2 branches missed.">        if (isNeedsPaging()) {</span>
<span class="nc bnc" id="L1194" title="All 2 branches missed.">            if (AbstractEngineConfiguration.DATABASE_TYPE_ORACLE.equals(databaseType)</span>
<span class="nc bnc" id="L1195" title="All 2 branches missed.">                    || AbstractEngineConfiguration.DATABASE_TYPE_DB2.equals(databaseType)</span>
<span class="nc bnc" id="L1196" title="All 2 branches missed.">                    || AbstractEngineConfiguration.DATABASE_TYPE_MSSQL.equals(databaseType)) {</span>
                // When using oracle, db2 or mssql we don't need outer join for the process definition join.
                // It is not needed because the outer join order by is done by the row number instead
<span class="nc" id="L1199">                return false;</span>
            }
        }

<span class="nc" id="L1203">        return hasOrderByForColumn(HistoricCaseInstanceQueryProperty.CASE_DEFINITION_KEY.getName());</span>
    }

    public List&lt;List&lt;String&gt;&gt; getSafeInvolvedGroups() {
<span class="nc" id="L1207">        return safeInvolvedGroups;</span>
    }

    public void setSafeInvolvedGroups(List&lt;List&lt;String&gt;&gt; safeInvolvedGroups) {
<span class="nc" id="L1211">        this.safeInvolvedGroups = safeInvolvedGroups;</span>
<span class="nc" id="L1212">    }</span>

    public String getRootScopeId() {
<span class="nc" id="L1215">        return rootScopeId;</span>
    }

    public String getParentScopeId() {
<span class="nc" id="L1219">        return parentScopeId;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>