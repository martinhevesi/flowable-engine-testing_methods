<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CompositeCmmnHistoryManager.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jacoco.exec</a> &gt; <a href="index.source.html" class="el_package">org.flowable.cmmn.engine.impl.history</a> &gt; <span class="el_source">CompositeCmmnHistoryManager.java</span></div><h1>CompositeCmmnHistoryManager.java</h1><pre class="source lang-java linenums">/* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.flowable.cmmn.engine.impl.history;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Date;

import org.flowable.cmmn.api.repository.CaseDefinition;
import org.flowable.cmmn.engine.impl.persistence.entity.CaseInstanceEntity;
import org.flowable.cmmn.engine.impl.persistence.entity.MilestoneInstanceEntity;
import org.flowable.cmmn.engine.impl.persistence.entity.PlanItemInstanceEntity;
import org.flowable.entitylink.service.impl.persistence.entity.EntityLinkEntity;
import org.flowable.identitylink.service.impl.persistence.entity.IdentityLinkEntity;
import org.flowable.task.api.history.HistoricTaskInstance;
import org.flowable.task.api.history.HistoricTaskLogEntryBuilder;
import org.flowable.task.service.impl.persistence.entity.TaskEntity;
import org.flowable.variable.service.impl.persistence.entity.VariableInstanceEntity;

/**
 * @author Filip Hrisafov
 */
public class CompositeCmmnHistoryManager implements CmmnHistoryManager {

    protected final Collection&lt;CmmnHistoryManager&gt; historyManagers;

<span class="nc" id="L37">    public CompositeCmmnHistoryManager(Collection&lt;CmmnHistoryManager&gt; historyManagers) {</span>
<span class="nc" id="L38">        this.historyManagers = new ArrayList&lt;&gt;(historyManagers);</span>
<span class="nc" id="L39">    }</span>

    @Override
    public void recordCaseInstanceStart(CaseInstanceEntity caseInstanceEntity) {
<span class="nc bnc" id="L43" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L44">            historyManager.recordCaseInstanceStart(caseInstanceEntity);</span>
<span class="nc" id="L45">        }</span>

<span class="nc" id="L47">    }</span>

    @Override
    public void recordCaseInstanceEnd(CaseInstanceEntity caseInstanceEntity, String state, Date endTime) {
<span class="nc bnc" id="L51" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L52">            historyManager.recordCaseInstanceEnd(caseInstanceEntity, state, endTime);</span>
<span class="nc" id="L53">        }</span>
<span class="nc" id="L54">    }</span>

    @Override
    public void recordHistoricCaseInstanceReactivated(CaseInstanceEntity caseInstanceEntity) {
<span class="nc bnc" id="L58" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L59">            historyManager.recordHistoricCaseInstanceReactivated(caseInstanceEntity);</span>
<span class="nc" id="L60">        }</span>
<span class="nc" id="L61">    }</span>

    @Override
    public void recordUpdateCaseInstanceName(CaseInstanceEntity caseInstanceEntity, String name) {
<span class="nc bnc" id="L65" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L66">            historyManager.recordUpdateCaseInstanceName(caseInstanceEntity, name);</span>
<span class="nc" id="L67">        }</span>
<span class="nc" id="L68">    }</span>
    
    @Override
    public void recordUpdateBusinessKey(CaseInstanceEntity caseInstanceEntity, String businessKey) {
<span class="nc bnc" id="L72" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L73">            historyManager.recordUpdateBusinessKey(caseInstanceEntity, businessKey);</span>
<span class="nc" id="L74">        }</span>
<span class="nc" id="L75">    }</span>
    
    @Override
    public void recordUpdateBusinessStatus(CaseInstanceEntity caseInstanceEntity, String businessStatus) {
<span class="nc bnc" id="L79" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L80">            historyManager.recordUpdateBusinessStatus(caseInstanceEntity, businessStatus);</span>
<span class="nc" id="L81">        }</span>
<span class="nc" id="L82">    }</span>

    @Override
    public void recordMilestoneReached(MilestoneInstanceEntity milestoneInstanceEntity) {
<span class="nc bnc" id="L86" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L87">            historyManager.recordMilestoneReached(milestoneInstanceEntity);</span>
<span class="nc" id="L88">        }</span>
<span class="nc" id="L89">    }</span>

    @Override
    public void recordHistoricCaseInstanceDeleted(String caseInstanceId, String tenantId) {
<span class="nc bnc" id="L93" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L94">            historyManager.recordHistoricCaseInstanceDeleted(caseInstanceId, tenantId);</span>
<span class="nc" id="L95">        }</span>
<span class="nc" id="L96">    }</span>

    @Override
    public void recordBulkDeleteHistoricCaseInstances(Collection&lt;String&gt; caseInstanceIds) {
<span class="nc bnc" id="L100" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L101">            historyManager.recordBulkDeleteHistoricCaseInstances(caseInstanceIds);</span>
<span class="nc" id="L102">        }</span>
<span class="nc" id="L103">    }</span>

    @Override
    public void recordIdentityLinkCreated(IdentityLinkEntity identityLink) {
<span class="nc bnc" id="L107" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L108">            historyManager.recordIdentityLinkCreated(identityLink);</span>
<span class="nc" id="L109">        }</span>
<span class="nc" id="L110">    }</span>

    @Override
    public void recordIdentityLinkDeleted(IdentityLinkEntity identityLink) {
<span class="nc bnc" id="L114" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L115">            historyManager.recordIdentityLinkDeleted(identityLink);</span>
<span class="nc" id="L116">        }</span>
<span class="nc" id="L117">    }</span>

    @Override
    public void recordEntityLinkCreated(EntityLinkEntity entityLink) {
<span class="nc bnc" id="L121" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L122">            historyManager.recordEntityLinkCreated(entityLink);</span>
<span class="nc" id="L123">        }</span>
<span class="nc" id="L124">    }</span>

    @Override
    public void recordEntityLinkDeleted(EntityLinkEntity entityLink) {
<span class="nc bnc" id="L128" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L129">            historyManager.recordEntityLinkDeleted(entityLink);</span>
<span class="nc" id="L130">        }</span>
<span class="nc" id="L131">    }</span>

    @Override
    public void recordVariableCreate(VariableInstanceEntity variable, Date createTime) {
<span class="nc bnc" id="L135" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L136">            historyManager.recordVariableCreate(variable, createTime);</span>
<span class="nc" id="L137">        }</span>
<span class="nc" id="L138">    }</span>

    @Override
    public void recordVariableUpdate(VariableInstanceEntity variable, Date updateTime) {
<span class="nc bnc" id="L142" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L143">            historyManager.recordVariableUpdate(variable, updateTime);</span>
<span class="nc" id="L144">        }</span>
<span class="nc" id="L145">    }</span>

    @Override
    public void recordVariableRemoved(VariableInstanceEntity variable) {
<span class="nc bnc" id="L149" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L150">            historyManager.recordVariableRemoved(variable);</span>
<span class="nc" id="L151">        }</span>
<span class="nc" id="L152">    }</span>

    @Override
    public void recordTaskCreated(TaskEntity task) {
<span class="nc bnc" id="L156" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L157">            historyManager.recordTaskCreated(task);</span>
<span class="nc" id="L158">        }</span>
<span class="nc" id="L159">    }</span>

    @Override
    public void recordTaskEnd(TaskEntity task, String userId, String deleteReason, Date endTime) {
<span class="nc bnc" id="L163" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L164">            historyManager.recordTaskEnd(task, userId, deleteReason, endTime);</span>
<span class="nc" id="L165">        }</span>
<span class="nc" id="L166">    }</span>

    @Override
    public void recordTaskInfoChange(TaskEntity taskEntity, Date changeTime) {
<span class="nc bnc" id="L170" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L171">            historyManager.recordTaskInfoChange(taskEntity, changeTime);</span>
<span class="nc" id="L172">        }</span>
<span class="nc" id="L173">    }</span>

    @Override
    public void recordHistoricTaskDeleted(HistoricTaskInstance task) {
<span class="nc bnc" id="L177" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L178">            historyManager.recordHistoricTaskDeleted(task);</span>
<span class="nc" id="L179">        }</span>
<span class="nc" id="L180">    }</span>

    @Override
    public void recordPlanItemInstanceCreated(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L184" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L185">            historyManager.recordPlanItemInstanceCreated(planItemInstanceEntity);</span>
<span class="nc" id="L186">        }</span>
<span class="nc" id="L187">    }</span>

    @Override
    public void recordPlanItemInstanceReactivated(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L191" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L192">            historyManager.recordPlanItemInstanceReactivated(planItemInstanceEntity);</span>
<span class="nc" id="L193">        }</span>
<span class="nc" id="L194">    }</span>

    @Override
    public void recordPlanItemInstanceUpdated(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L198" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L199">            historyManager.recordPlanItemInstanceUpdated(planItemInstanceEntity);</span>
<span class="nc" id="L200">        }</span>
<span class="nc" id="L201">    }</span>

    @Override
    public void recordPlanItemInstanceAvailable(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L205" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L206">            historyManager.recordPlanItemInstanceAvailable(planItemInstanceEntity);</span>
<span class="nc" id="L207">        }</span>
<span class="nc" id="L208">    }</span>

    @Override
    public void recordPlanItemInstanceUnavailable(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L212" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L213">            historyManager.recordPlanItemInstanceUnavailable(planItemInstanceEntity);</span>
<span class="nc" id="L214">        }</span>
<span class="nc" id="L215">    }</span>

    @Override
    public void recordPlanItemInstanceEnabled(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L219" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L220">            historyManager.recordPlanItemInstanceEnabled(planItemInstanceEntity);</span>
<span class="nc" id="L221">        }</span>
<span class="nc" id="L222">    }</span>

    @Override
    public void recordPlanItemInstanceDisabled(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L226" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L227">            historyManager.recordPlanItemInstanceDisabled(planItemInstanceEntity);</span>
<span class="nc" id="L228">        }</span>
<span class="nc" id="L229">    }</span>

    @Override
    public void recordPlanItemInstanceStarted(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L233" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L234">            historyManager.recordPlanItemInstanceStarted(planItemInstanceEntity);</span>
<span class="nc" id="L235">        }</span>
<span class="nc" id="L236">    }</span>

    @Override
    public void recordPlanItemInstanceSuspended(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L240" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L241">            historyManager.recordPlanItemInstanceSuspended(planItemInstanceEntity);</span>
<span class="nc" id="L242">        }</span>
<span class="nc" id="L243">    }</span>

    @Override
    public void recordPlanItemInstanceCompleted(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L247" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L248">            historyManager.recordPlanItemInstanceCompleted(planItemInstanceEntity);</span>
<span class="nc" id="L249">        }</span>
<span class="nc" id="L250">    }</span>

    @Override
    public void recordPlanItemInstanceOccurred(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L254" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L255">            historyManager.recordPlanItemInstanceOccurred(planItemInstanceEntity);</span>
<span class="nc" id="L256">        }</span>
<span class="nc" id="L257">    }</span>

    @Override
    public void recordPlanItemInstanceTerminated(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L261" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L262">            historyManager.recordPlanItemInstanceTerminated(planItemInstanceEntity);</span>
<span class="nc" id="L263">        }</span>
<span class="nc" id="L264">    }</span>

    @Override
    public void recordPlanItemInstanceExit(PlanItemInstanceEntity planItemInstanceEntity) {
<span class="nc bnc" id="L268" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L269">            historyManager.recordPlanItemInstanceExit(planItemInstanceEntity);</span>
<span class="nc" id="L270">        }</span>
<span class="nc" id="L271">    }</span>
    
    @Override
    public void updateCaseDefinitionIdInHistory(CaseDefinition caseDefinition, CaseInstanceEntity caseInstance) {
<span class="nc bnc" id="L275" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L276">            historyManager.updateCaseDefinitionIdInHistory(caseDefinition, caseInstance);</span>
<span class="nc" id="L277">        }</span>
<span class="nc" id="L278">    }</span>

    @Override
    public void recordHistoricUserTaskLogEntry(HistoricTaskLogEntryBuilder taskLogEntryBuilder) {
<span class="nc bnc" id="L282" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L283">            historyManager.recordHistoricUserTaskLogEntry(taskLogEntryBuilder);</span>
<span class="nc" id="L284">        }</span>
<span class="nc" id="L285">    }</span>

    @Override
    public void deleteHistoricUserTaskLogEntry(long logNumber) {
<span class="nc bnc" id="L289" title="All 2 branches missed.">        for (CmmnHistoryManager historyManager : historyManagers) {</span>
<span class="nc" id="L290">            historyManager.deleteHistoricUserTaskLogEntry(logNumber);</span>
<span class="nc" id="L291">        }</span>
<span class="nc" id="L292">    }</span>

    public void addHistoryManager(CmmnHistoryManager historyManager) {
<span class="nc" id="L295">        historyManagers.add(historyManager);</span>
<span class="nc" id="L296">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>