<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>FlowableEventBuilder.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jacoco.exec</a> &gt; <a href="index.source.html" class="el_package">org.flowable.engine.delegate.event.impl</a> &gt; <span class="el_source">FlowableEventBuilder.java</span></div><h1>FlowableEventBuilder.java</h1><pre class="source lang-java linenums">/* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.flowable.engine.delegate.event.impl;

import java.util.Map;

import org.flowable.bpmn.model.Activity;
import org.flowable.bpmn.model.FlowElement;
import org.flowable.bpmn.model.FlowNode;
import org.flowable.common.engine.api.delegate.event.FlowableEngineEventType;
import org.flowable.common.engine.api.delegate.event.FlowableEntityEvent;
import org.flowable.common.engine.api.delegate.event.FlowableEvent;
import org.flowable.common.engine.api.delegate.event.FlowableExceptionEvent;
import org.flowable.common.engine.impl.event.FlowableEngineEventImpl;
import org.flowable.engine.delegate.DelegateExecution;
import org.flowable.engine.delegate.event.FlowableActivityCancelledEvent;
import org.flowable.engine.delegate.event.FlowableActivityEvent;
import org.flowable.engine.delegate.event.FlowableCancelledEvent;
import org.flowable.engine.delegate.event.FlowableConditionalEvent;
import org.flowable.engine.delegate.event.FlowableEntityWithVariablesEvent;
import org.flowable.engine.delegate.event.FlowableErrorEvent;
import org.flowable.engine.delegate.event.FlowableEscalationEvent;
import org.flowable.engine.delegate.event.FlowableJobRescheduledEvent;
import org.flowable.engine.delegate.event.FlowableMessageEvent;
import org.flowable.engine.delegate.event.FlowableMultiInstanceActivityCancelledEvent;
import org.flowable.engine.delegate.event.FlowableMultiInstanceActivityCompletedEvent;
import org.flowable.engine.delegate.event.FlowableMultiInstanceActivityEvent;
import org.flowable.engine.delegate.event.FlowableProcessStartedEvent;
import org.flowable.engine.delegate.event.FlowableProcessTerminatedEvent;
import org.flowable.engine.delegate.event.FlowableSequenceFlowTakenEvent;
import org.flowable.engine.delegate.event.FlowableSignalEvent;
import org.flowable.engine.impl.context.ExecutionContext;
import org.flowable.engine.impl.persistence.entity.ExecutionEntity;
import org.flowable.engine.repository.ProcessDefinition;
import org.flowable.identitylink.service.impl.persistence.entity.IdentityLinkEntity;
import org.flowable.job.api.Job;
import org.flowable.task.api.Task;
import org.flowable.variable.api.event.FlowableVariableEvent;
import org.flowable.variable.api.types.VariableType;

/**
 * Builder class used to create {@link FlowableEvent} implementations.
 *
 * @author Frederik Heremans
 */
<span class="nc" id="L56">public class FlowableEventBuilder {</span>

    /**
     * @param type
     *            type of event
     * @return an {@link FlowableEvent} that doesn't have it's execution context-fields filled, as the event is a global event, independent of any running execution.
     */
    public static FlowableEvent createGlobalEvent(FlowableEngineEventType type) {
<span class="nc" id="L64">        FlowableEngineEventImpl newEvent = new FlowableProcessEventImpl(type);</span>
<span class="nc" id="L65">        return newEvent;</span>
    }

    public static FlowableEvent createEvent(FlowableEngineEventType type, String executionId, String processInstanceId, String processDefinitionId) {
<span class="nc" id="L69">        FlowableEngineEventImpl newEvent = new FlowableProcessEventImpl(type);</span>
<span class="nc" id="L70">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L71">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L72">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L73">        return newEvent;</span>
    }

    /**
     * @param type
     *            type of event
     * @param entity
     *            the entity this event targets
     * @return an {@link FlowableEntityEvent}. In case an {@link ExecutionContext} is active, the execution related event fields will be populated. If not, execution details will be retrieved from the
     *         {@link Object} if possible.
     */
    public static FlowableEntityEvent createEntityEvent(FlowableEngineEventType type, Object entity) {
<span class="nc" id="L85">        FlowableEntityEventImpl newEvent = new FlowableEntityEventImpl(entity, type);</span>

        // In case an execution-context is active, populate the event fields
        // related to the execution
<span class="nc" id="L89">        populateEventWithCurrentContext(newEvent);</span>
<span class="nc" id="L90">        return newEvent;</span>
    }

    /**
     * @param entity
     *            the entity this event targets
     * @param variables
     *            the variables associated with this entity
     * @return an {@link FlowableEntityEvent}. In case an {@link ExecutionContext} is active, the execution related event fields will be populated. If not, execution details will be retrieved from the
     *         {@link Object} if possible.
     */
    @SuppressWarnings(&quot;rawtypes&quot;)
    public static FlowableProcessStartedEvent createProcessStartedEvent(final Object entity,
            final Map variables, final boolean localScope) {
<span class="nc" id="L104">        final FlowableProcessStartedEventImpl newEvent = new FlowableProcessStartedEventImpl(entity, variables, localScope);</span>

        // In case an execution-context is active, populate the event fields related to the execution
<span class="nc" id="L107">        populateEventWithCurrentContext(newEvent);</span>
<span class="nc" id="L108">        return newEvent;</span>
    }

    /**
     * @param type
     *            type of event
     * @param entity
     *            the entity this event targets
     * @param variables
     *            the variables associated with this entity
     * @return an {@link FlowableEntityEvent}. In case an {@link ExecutionContext} is active, the execution related event fields will be populated. If not, execution details will be retrieved from the
     *         {@link Object} if possible.
     */
    @SuppressWarnings(&quot;rawtypes&quot;)
    public static FlowableEntityWithVariablesEvent createEntityWithVariablesEvent(FlowableEngineEventType type, Object entity, Map variables, boolean localScope) {
<span class="nc" id="L123">        FlowableEntityWithVariablesEventImpl newEvent = new FlowableEntityWithVariablesEventImpl(entity, variables, localScope, type);</span>

        // In case an execution-context is active, populate the event fields
        // related to the execution
<span class="nc" id="L127">        populateEventWithCurrentContext(newEvent);</span>
<span class="nc" id="L128">        return newEvent;</span>
    }

    /**
     * @param type
     *            type of event
     * @param newJob
     *            the new job that was created due to the reschedule
     * @param originalJobId
     *            the job id of the original job that was rescheduled
     * @return an {@link FlowableEntityEvent}. In case an {@link ExecutionContext} is active, the execution related event fields will be populated. If not, execution details will be retrieved from the
     *         {@link Object} if possible.
     */
    public static FlowableJobRescheduledEvent createJobRescheduledEvent(FlowableEngineEventType type, Job newJob, String originalJobId) {
<span class="nc" id="L142">        FlowableJobRescheduledEventImpl newEvent = new FlowableJobRescheduledEventImpl(newJob, originalJobId, type);</span>

<span class="nc" id="L144">        populateEventWithCurrentContext(newEvent);</span>
<span class="nc" id="L145">        return newEvent;</span>
    }

    public static FlowableSequenceFlowTakenEvent createSequenceFlowTakenEvent(ExecutionEntity executionEntity, FlowableEngineEventType type,
            String sequenceFlowId, String sourceActivityId, String sourceActivityName, String sourceActivityType, Object sourceActivityBehavior,
            String targetActivityId, String targetActivityName, String targetActivityType, Object targetActivityBehavior) {

<span class="nc" id="L152">        FlowableSequenceFlowTakenEventImpl newEvent = new FlowableSequenceFlowTakenEventImpl(type);</span>

<span class="nc bnc" id="L154" title="All 2 branches missed.">        if (executionEntity != null) {</span>
<span class="nc" id="L155">            newEvent.setExecutionId(executionEntity.getId());</span>
<span class="nc" id="L156">            newEvent.setProcessInstanceId(executionEntity.getProcessInstanceId());</span>
<span class="nc" id="L157">            newEvent.setProcessDefinitionId(executionEntity.getProcessDefinitionId());</span>
        }

<span class="nc" id="L160">        newEvent.setId(sequenceFlowId);</span>
<span class="nc" id="L161">        newEvent.setSourceActivityId(sourceActivityId);</span>
<span class="nc" id="L162">        newEvent.setSourceActivityName(sourceActivityName);</span>
<span class="nc" id="L163">        newEvent.setSourceActivityType(sourceActivityType);</span>
<span class="nc bnc" id="L164" title="All 2 branches missed.">        newEvent.setSourceActivityBehaviorClass(sourceActivityBehavior != null ? sourceActivityBehavior.getClass().getCanonicalName() : null);</span>
<span class="nc" id="L165">        newEvent.setTargetActivityId(targetActivityId);</span>
<span class="nc" id="L166">        newEvent.setTargetActivityName(targetActivityName);</span>
<span class="nc" id="L167">        newEvent.setTargetActivityType(targetActivityType);</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">        newEvent.setTargetActivityBehaviorClass(targetActivityBehavior != null ? targetActivityBehavior.getClass().getCanonicalName() : null);</span>

<span class="nc" id="L170">        return newEvent;</span>
    }

    /**
     * @param type
     *            type of event
     * @param entity
     *            the entity this event targets
     * @return an {@link FlowableEntityEvent}
     */
    public static FlowableEntityEvent createEntityEvent(FlowableEngineEventType type, Object entity, String executionId, String processInstanceId, String processDefinitionId) {
<span class="nc" id="L181">        FlowableEntityEventImpl newEvent = new FlowableEntityEventImpl(entity, type);</span>

<span class="nc" id="L183">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L184">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L185">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L186">        return newEvent;</span>
    }

    /**
     * @param type
     *            type of event
     * @param entity
     *            the entity this event targets
     * @param cause
     *            the cause of the event
     * @return an {@link FlowableEntityEvent} that is also instance of {@link FlowableExceptionEvent}. In case an {@link ExecutionContext} is active, the execution related event fields will be
     *         populated.
     */
    public static FlowableEntityEvent createEntityExceptionEvent(FlowableEngineEventType type, Object entity, Throwable cause) {
<span class="nc" id="L200">        FlowableEntityExceptionEventImpl newEvent = new FlowableEntityExceptionEventImpl(entity, type, cause);</span>

        // In case an execution-context is active, populate the event fields
        // related to the execution
<span class="nc" id="L204">        populateEventWithCurrentContext(newEvent);</span>
<span class="nc" id="L205">        return newEvent;</span>
    }

    /**
     * @param type
     *            type of event
     * @param entity
     *            the entity this event targets
     * @param cause
     *            the cause of the event
     * @return an {@link FlowableEntityEvent} that is also instance of {@link FlowableExceptionEvent}.
     */
    public static FlowableEntityEvent createEntityExceptionEvent(FlowableEngineEventType type, Object entity, Throwable cause, String executionId, String processInstanceId, String processDefinitionId) {
<span class="nc" id="L218">        FlowableEntityExceptionEventImpl newEvent = new FlowableEntityExceptionEventImpl(entity, type, cause);</span>

<span class="nc" id="L220">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L221">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L222">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L223">        return newEvent;</span>
    }

    public static FlowableActivityEvent createActivityEvent(FlowableEngineEventType type, String activityId, String activityName, String executionId,
            String processInstanceId, String processDefinitionId, FlowElement flowElement) {

<span class="nc" id="L229">        FlowableActivityEventImpl newEvent = new FlowableActivityEventImpl(type);</span>
<span class="nc" id="L230">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L231">        newEvent.setActivityName(activityName);</span>
<span class="nc" id="L232">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L233">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L234">        newEvent.setProcessInstanceId(processInstanceId);</span>

<span class="nc bnc" id="L236" title="All 2 branches missed.">        if (flowElement instanceof FlowNode) {</span>
<span class="nc" id="L237">            FlowNode flowNode = (FlowNode) flowElement;</span>
<span class="nc" id="L238">            newEvent.setActivityType(parseActivityType(flowNode));</span>
<span class="nc" id="L239">            Object behaviour = flowNode.getBehavior();</span>
<span class="nc bnc" id="L240" title="All 2 branches missed.">            if (behaviour != null) {</span>
<span class="nc" id="L241">                newEvent.setBehaviorClass(behaviour.getClass().getCanonicalName());</span>
            }
        }

<span class="nc" id="L245">        return newEvent;</span>
    }

    public static FlowableMultiInstanceActivityEvent createMultiInstanceActivityEvent(FlowableEngineEventType type, String activityId, String activityName,
            String executionId, String processInstanceId, String processDefinitionId, FlowElement flowElement) {

<span class="nc" id="L251">        FlowableMultiInstanceActivityEventImpl newEvent = new FlowableMultiInstanceActivityEventImpl(type);</span>
<span class="nc" id="L252">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L253">        newEvent.setActivityName(activityName);</span>
<span class="nc" id="L254">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L255">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L256">        newEvent.setProcessInstanceId(processInstanceId);</span>

<span class="nc bnc" id="L258" title="All 2 branches missed.">        if (flowElement instanceof FlowNode) {</span>
<span class="nc" id="L259">            FlowNode flowNode = (FlowNode) flowElement;</span>
<span class="nc" id="L260">            newEvent.setActivityType(parseActivityType(flowNode));</span>
<span class="nc" id="L261">            Object behaviour = flowNode.getBehavior();</span>
<span class="nc bnc" id="L262" title="All 2 branches missed.">            if (behaviour != null) {</span>
<span class="nc" id="L263">                newEvent.setBehaviorClass(behaviour.getClass().getCanonicalName());</span>
            }

<span class="nc" id="L266">            newEvent.setSequential(((Activity) flowNode).getLoopCharacteristics().isSequential());</span>
        }

<span class="nc" id="L269">        return newEvent;</span>
    }

    public static FlowableMultiInstanceActivityCompletedEvent createMultiInstanceActivityCompletedEvent(FlowableEngineEventType type, int numberOfInstances,
            int numberOfActiveInstances, int numberOfCompletedInstances, String activityId, String activityName, String executionId, String processInstanceId,
            String processDefinitionId, FlowElement flowElement) {

<span class="nc" id="L276">        FlowableMultiInstanceActivityCompletedEventImpl newEvent = new FlowableMultiInstanceActivityCompletedEventImpl(type);</span>
<span class="nc" id="L277">        newEvent.setNumberOfInstances(numberOfInstances);</span>
<span class="nc" id="L278">        newEvent.setNumberOfActiveInstances(numberOfActiveInstances);</span>
<span class="nc" id="L279">        newEvent.setNumberOfCompletedInstances(numberOfCompletedInstances);</span>
<span class="nc" id="L280">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L281">        newEvent.setActivityName(activityName);</span>
<span class="nc" id="L282">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L283">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L284">        newEvent.setProcessInstanceId(processInstanceId);</span>

<span class="nc bnc" id="L286" title="All 2 branches missed.">        if (flowElement instanceof FlowNode) {</span>
<span class="nc" id="L287">            FlowNode flowNode = (FlowNode) flowElement;</span>
<span class="nc" id="L288">            newEvent.setActivityType(parseActivityType(flowNode));</span>
<span class="nc" id="L289">            Object behaviour = flowNode.getBehavior();</span>
<span class="nc bnc" id="L290" title="All 2 branches missed.">            if (behaviour != null) {</span>
<span class="nc" id="L291">                newEvent.setBehaviorClass(behaviour.getClass().getCanonicalName());</span>
            }

<span class="nc" id="L294">            newEvent.setSequential(((Activity) flowNode).getLoopCharacteristics().isSequential());</span>
        }

<span class="nc" id="L297">        return newEvent;</span>
    }

    protected static String parseActivityType(FlowNode flowNode) {
<span class="nc" id="L301">        String elementType = flowNode.getClass().getSimpleName();</span>
<span class="nc" id="L302">        elementType = elementType.substring(0, 1).toLowerCase() + elementType.substring(1);</span>
<span class="nc" id="L303">        return elementType;</span>
    }

    public static FlowableActivityCancelledEvent createActivityCancelledEvent(String activityId, String activityName, String executionId,
            String processInstanceId, String processDefinitionId, String activityType, Object cause) {

<span class="nc" id="L309">        FlowableActivityCancelledEventImpl newEvent = new FlowableActivityCancelledEventImpl();</span>
<span class="nc" id="L310">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L311">        newEvent.setActivityName(activityName);</span>
<span class="nc" id="L312">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L313">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L314">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L315">        newEvent.setActivityType(activityType);</span>
<span class="nc" id="L316">        newEvent.setCause(cause);</span>
<span class="nc" id="L317">        return newEvent;</span>
    }

    public static FlowableMultiInstanceActivityCancelledEvent createMultiInstanceActivityCancelledEvent(String activityId, String activityName,
            String executionId,String processInstanceId, String processDefinitionId, String activityType, Object cause) {

<span class="nc" id="L323">        FlowableMultiInstanceActivityCancelledEventImpl newEvent = new FlowableMultiInstanceActivityCancelledEventImpl();</span>
<span class="nc" id="L324">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L325">        newEvent.setActivityName(activityName);</span>
<span class="nc" id="L326">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L327">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L328">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L329">        newEvent.setActivityType(activityType);</span>
<span class="nc" id="L330">        newEvent.setCause(cause);</span>
<span class="nc" id="L331">        return newEvent;</span>
    }

    public static FlowableCancelledEvent createCancelledEvent(String executionId, String processInstanceId, String processDefinitionId, Object cause) {
<span class="nc" id="L335">        FlowableProcessCancelledEventImpl newEvent = new FlowableProcessCancelledEventImpl();</span>
<span class="nc" id="L336">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L337">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L338">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L339">        newEvent.setCause(cause);</span>
<span class="nc" id="L340">        return newEvent;</span>
    }

    public static FlowableProcessTerminatedEvent createTerminateEvent(ExecutionEntity execution, Object cause) {
<span class="nc" id="L344">        return new FlowableProcessTerminatedEventImpl(execution, cause);</span>
    }

    public static FlowableSignalEvent createSignalEvent(FlowableEngineEventType type, String activityId, String signalName, Object signalData, String executionId, String processInstanceId,
            String processDefinitionId) {
<span class="nc" id="L349">        FlowableSignalEventImpl newEvent = new FlowableSignalEventImpl(type);</span>
<span class="nc" id="L350">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L351">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L352">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L353">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L354">        newEvent.setSignalName(signalName);</span>
<span class="nc" id="L355">        newEvent.setSignalData(signalData);</span>
<span class="nc" id="L356">        return newEvent;</span>
    }

    public static FlowableMessageEvent createMessageEvent(FlowableEngineEventType type, String activityId, String messageName, Object payload, 
                    String executionId, String processInstanceId, String processDefinitionId) {
<span class="nc" id="L361">        FlowableMessageEventImpl newEvent = new FlowableMessageEventImpl(type);</span>
<span class="nc" id="L362">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L363">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L364">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L365">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L366">        newEvent.setMessageName(messageName);</span>
<span class="nc" id="L367">        newEvent.setMessageData(payload);</span>
<span class="nc" id="L368">        return newEvent;</span>
    }
    
    public static FlowableConditionalEvent createConditionalEvent(FlowableEngineEventType type, String activityId, String conditionExpression,
                    String executionId, String processInstanceId, String processDefinitionId) {
        
<span class="nc" id="L374">        FlowableConditionalEventImpl newEvent = new FlowableConditionalEventImpl(type);</span>
<span class="nc" id="L375">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L376">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L377">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L378">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L379">        newEvent.setConditionExpression(conditionExpression);</span>
<span class="nc" id="L380">        return newEvent;</span>
    }
    
    public static FlowableEscalationEvent createEscalationEvent(FlowableEngineEventType type, String activityId, String escalationCode, String escalationName,
                    String executionId, String processInstanceId, String processDefinitionId) {
<span class="nc" id="L385">        FlowableEscalationEventImpl newEvent = new FlowableEscalationEventImpl(type);</span>
<span class="nc" id="L386">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L387">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L388">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L389">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L390">        newEvent.setEscalationCode(escalationCode);</span>
<span class="nc" id="L391">        newEvent.setEscalationName(escalationName);</span>
<span class="nc" id="L392">        return newEvent;</span>
    }

    public static FlowableErrorEvent createErrorEvent(FlowableEngineEventType type, String activityId, String errorId, String errorCode,
            String executionId, String processInstanceId, String processDefinitionId) {
<span class="nc" id="L397">        FlowableErrorEventImpl newEvent = new FlowableErrorEventImpl(type);</span>
<span class="nc" id="L398">        newEvent.setActivityId(activityId);</span>
<span class="nc" id="L399">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L400">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L401">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L402">        newEvent.setErrorId(errorId);</span>
<span class="nc" id="L403">        newEvent.setErrorCode(errorCode);</span>
<span class="nc" id="L404">        return newEvent;</span>
    }

    public static FlowableVariableEvent createVariableEvent(FlowableEngineEventType type, String variableName, Object variableValue, VariableType variableType, String taskId, String executionId,
            String processInstanceId, String processDefinitionId, String variableInstanceId) {
<span class="nc" id="L409">        FlowableVariableEventImpl newEvent = new FlowableVariableEventImpl(type);</span>
<span class="nc" id="L410">        newEvent.setVariableName(variableName);</span>
<span class="nc" id="L411">        newEvent.setVariableValue(variableValue);</span>
<span class="nc" id="L412">        newEvent.setVariableType(variableType);</span>
<span class="nc" id="L413">        newEvent.setTaskId(taskId);</span>
<span class="nc" id="L414">        newEvent.setExecutionId(executionId);</span>
<span class="nc" id="L415">        newEvent.setProcessDefinitionId(processDefinitionId);</span>
<span class="nc" id="L416">        newEvent.setProcessInstanceId(processInstanceId);</span>
<span class="nc" id="L417">        newEvent.setVariableInstanceId(variableInstanceId);</span>
<span class="nc" id="L418">        return newEvent;</span>
    }

    protected static void populateEventWithCurrentContext(FlowableEngineEventImpl event) {
<span class="nc bnc" id="L422" title="All 2 branches missed.">        if (event instanceof FlowableEntityEvent) {</span>
<span class="nc" id="L423">            Object persistedObject = ((FlowableEntityEvent) event).getEntity();</span>
<span class="nc bnc" id="L424" title="All 2 branches missed.">            if (persistedObject instanceof Job) {</span>
<span class="nc" id="L425">                event.setExecutionId(((Job) persistedObject).getExecutionId());</span>
<span class="nc" id="L426">                event.setProcessInstanceId(((Job) persistedObject).getProcessInstanceId());</span>
<span class="nc" id="L427">                event.setProcessDefinitionId(((Job) persistedObject).getProcessDefinitionId());</span>
                
<span class="nc bnc" id="L429" title="All 2 branches missed.">            } else if (persistedObject instanceof DelegateExecution) {</span>
<span class="nc" id="L430">                event.setExecutionId(((DelegateExecution) persistedObject).getId());</span>
<span class="nc" id="L431">                event.setProcessInstanceId(((DelegateExecution) persistedObject).getProcessInstanceId());</span>
<span class="nc" id="L432">                event.setProcessDefinitionId(((DelegateExecution) persistedObject).getProcessDefinitionId());</span>
                
<span class="nc bnc" id="L434" title="All 2 branches missed.">            } else if (persistedObject instanceof IdentityLinkEntity) {</span>
<span class="nc" id="L435">                IdentityLinkEntity idLink = (IdentityLinkEntity) persistedObject;</span>
<span class="nc bnc" id="L436" title="All 2 branches missed.">                if (idLink.getProcessDefinitionId() != null) {</span>
<span class="nc" id="L437">                    event.setProcessDefinitionId(idLink.getProcessDefId());</span>
                    
<span class="nc bnc" id="L439" title="All 2 branches missed.">                } else if (idLink.getProcessInstanceId() != null) {</span>
<span class="nc" id="L440">                    event.setProcessDefinitionId(idLink.getProcessDefId());</span>
<span class="nc" id="L441">                    event.setProcessInstanceId(idLink.getProcessInstanceId());</span>
                    
<span class="nc bnc" id="L443" title="All 2 branches missed.">                } else if (idLink.getTaskId() != null) {</span>
<span class="nc" id="L444">                    event.setProcessDefinitionId(idLink.getProcessDefId());</span>
                }
                
<span class="nc bnc" id="L447" title="All 2 branches missed.">            } else if (persistedObject instanceof Task) {</span>
<span class="nc" id="L448">                event.setProcessInstanceId(((Task) persistedObject).getProcessInstanceId());</span>
<span class="nc" id="L449">                event.setExecutionId(((Task) persistedObject).getExecutionId());</span>
<span class="nc" id="L450">                event.setProcessDefinitionId(((Task) persistedObject).getProcessDefinitionId());</span>
                
<span class="nc bnc" id="L452" title="All 2 branches missed.">            } else if (persistedObject instanceof ProcessDefinition) {</span>
<span class="nc" id="L453">                event.setProcessDefinitionId(((ProcessDefinition) persistedObject).getId());</span>
            }
        }
<span class="nc" id="L456">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>