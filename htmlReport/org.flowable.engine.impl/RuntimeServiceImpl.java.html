<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>RuntimeServiceImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jacoco.exec</a> &gt; <a href="index.source.html" class="el_package">org.flowable.engine.impl</a> &gt; <span class="el_source">RuntimeServiceImpl.java</span></div><h1>RuntimeServiceImpl.java</h1><pre class="source lang-java linenums">/* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.flowable.engine.impl;

import java.util.ArrayList;
import java.util.Collection;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Set;

import org.flowable.bpmn.model.FlowNode;
import org.flowable.common.engine.api.FlowableIllegalArgumentException;
import org.flowable.common.engine.api.delegate.event.FlowableEngineEventType;
import org.flowable.common.engine.api.delegate.event.FlowableEvent;
import org.flowable.common.engine.api.delegate.event.FlowableEventListener;
import org.flowable.common.engine.impl.service.CommonEngineServiceImpl;
import org.flowable.engine.RuntimeService;
import org.flowable.engine.form.FormData;
import org.flowable.engine.impl.cfg.ProcessEngineConfigurationImpl;
import org.flowable.engine.impl.cmd.ActivateProcessInstanceCmd;
import org.flowable.engine.impl.cmd.AddEventConsumerCommand;
import org.flowable.engine.impl.cmd.AddEventListenerCommand;
import org.flowable.engine.impl.cmd.AddIdentityLinkForProcessInstanceCmd;
import org.flowable.engine.impl.cmd.AddMultiInstanceExecutionCmd;
import org.flowable.engine.impl.cmd.ChangeActivityStateCmd;
import org.flowable.engine.impl.cmd.CompleteAdhocSubProcessCmd;
import org.flowable.engine.impl.cmd.DeleteIdentityLinkForProcessInstanceCmd;
import org.flowable.engine.impl.cmd.DeleteMultiInstanceExecutionCmd;
import org.flowable.engine.impl.cmd.DeleteProcessInstanceCmd;
import org.flowable.engine.impl.cmd.DeleteProcessInstancesByIdCmd;
import org.flowable.engine.impl.cmd.DeleteProcessInstanceStartEventSubscriptionCmd;
import org.flowable.engine.impl.cmd.DispatchEventCommand;
import org.flowable.engine.impl.cmd.EvaluateConditionalEventsCmd;
import org.flowable.engine.impl.cmd.ExecuteActivityForAdhocSubProcessCmd;
import org.flowable.engine.impl.cmd.FindActiveActivityIdsCmd;
import org.flowable.engine.impl.cmd.GetActiveAdhocSubProcessesCmd;
import org.flowable.engine.impl.cmd.GetDataObjectCmd;
import org.flowable.engine.impl.cmd.GetDataObjectsCmd;
import org.flowable.engine.impl.cmd.GetEnabledActivitiesForAdhocSubProcessCmd;
import org.flowable.engine.impl.cmd.GetEntityLinkChildrenForProcessInstanceCmd;
import org.flowable.engine.impl.cmd.GetEntityLinkChildrenForTaskCmd;
import org.flowable.engine.impl.cmd.GetEntityLinkChildrenWithSameRootAsProcessInstanceCmd;
import org.flowable.engine.impl.cmd.GetEntityLinkParentsForProcessInstanceCmd;
import org.flowable.engine.impl.cmd.GetEntityLinkParentsForTaskCmd;
import org.flowable.engine.impl.cmd.GetExecutionVariableCmd;
import org.flowable.engine.impl.cmd.GetExecutionVariableInstanceCmd;
import org.flowable.engine.impl.cmd.GetExecutionVariableInstancesCmd;
import org.flowable.engine.impl.cmd.GetExecutionVariablesCmd;
import org.flowable.engine.impl.cmd.GetExecutionsVariablesCmd;
import org.flowable.engine.impl.cmd.GetIdentityLinksForProcessInstanceCmd;
import org.flowable.engine.impl.cmd.GetProcessInstanceEventsCmd;
import org.flowable.engine.impl.cmd.GetStartFormCmd;
import org.flowable.engine.impl.cmd.GetStartFormModelCmd;
import org.flowable.engine.impl.cmd.HasExecutionVariableCmd;
import org.flowable.engine.impl.cmd.MessageEventReceivedCmd;
import org.flowable.engine.impl.cmd.ModifyProcessInstanceStartEventSubscriptionCmd;
import org.flowable.engine.impl.cmd.RegisterProcessInstanceStartEventSubscriptionCmd;
import org.flowable.engine.impl.cmd.RemoveEventConsumerCommand;
import org.flowable.engine.impl.cmd.RemoveEventListenerCommand;
import org.flowable.engine.impl.cmd.RemoveExecutionVariablesCmd;
import org.flowable.engine.impl.cmd.RemoveProcessInstanceAssigneeCmd;
import org.flowable.engine.impl.cmd.RemoveProcessInstanceOwnerCmd;
import org.flowable.engine.impl.cmd.SetExecutionVariablesCmd;
import org.flowable.engine.impl.cmd.SetProcessInstanceAssigneeCmd;
import org.flowable.engine.impl.cmd.SetProcessInstanceBusinessKeyCmd;
import org.flowable.engine.impl.cmd.SetProcessInstanceBusinessStatusCmd;
import org.flowable.engine.impl.cmd.SetProcessInstanceNameCmd;
import org.flowable.engine.impl.cmd.SetProcessInstanceOwnerCmd;
import org.flowable.engine.impl.cmd.SignalEventReceivedCmd;
import org.flowable.engine.impl.cmd.StartProcessInstanceAsyncCmd;
import org.flowable.engine.impl.cmd.StartProcessInstanceByMessageCmd;
import org.flowable.engine.impl.cmd.StartProcessInstanceCmd;
import org.flowable.engine.impl.cmd.SuspendProcessInstanceCmd;
import org.flowable.engine.impl.cmd.TriggerCmd;
import org.flowable.engine.impl.runtime.ChangeActivityStateBuilderImpl;
import org.flowable.engine.impl.runtime.ProcessInstanceBuilderImpl;
import org.flowable.engine.impl.runtime.ProcessInstanceStartEventSubscriptionBuilderImpl;
import org.flowable.engine.impl.runtime.ProcessInstanceStartEventSubscriptionDeletionBuilderImpl;
import org.flowable.engine.impl.runtime.ProcessInstanceStartEventSubscriptionModificationBuilderImpl;
import org.flowable.engine.runtime.ChangeActivityStateBuilder;
import org.flowable.engine.runtime.DataObject;
import org.flowable.engine.runtime.Execution;
import org.flowable.engine.runtime.ExecutionQuery;
import org.flowable.engine.runtime.NativeExecutionQuery;
import org.flowable.engine.runtime.NativeProcessInstanceQuery;
import org.flowable.engine.runtime.ProcessInstance;
import org.flowable.engine.runtime.ProcessInstanceBuilder;
import org.flowable.engine.runtime.ProcessInstanceQuery;
import org.flowable.engine.runtime.ProcessInstanceStartEventSubscriptionBuilder;
import org.flowable.engine.runtime.ProcessInstanceStartEventSubscriptionDeletionBuilder;
import org.flowable.engine.runtime.ProcessInstanceStartEventSubscriptionModificationBuilder;
import org.flowable.engine.task.Event;
import org.flowable.entitylink.api.EntityLink;
import org.flowable.eventregistry.api.EventRegistryEventConsumer;
import org.flowable.eventsubscription.api.EventSubscription;
import org.flowable.eventsubscription.api.EventSubscriptionQuery;
import org.flowable.eventsubscription.service.impl.EventSubscriptionQueryImpl;
import org.flowable.form.api.FormInfo;
import org.flowable.identitylink.api.IdentityLink;
import org.flowable.identitylink.api.IdentityLinkType;
import org.flowable.variable.api.persistence.entity.VariableInstance;
import org.flowable.variable.api.runtime.NativeVariableInstanceQuery;
import org.flowable.variable.api.runtime.VariableInstanceQuery;
import org.flowable.variable.service.impl.NativeVariableInstanceQueryImpl;
import org.flowable.variable.service.impl.VariableInstanceQueryImpl;

/**
 * @author Tom Baeyens
 * @author Daniel Meyer
 */
public class RuntimeServiceImpl extends CommonEngineServiceImpl&lt;ProcessEngineConfigurationImpl&gt; implements RuntimeService {

    public RuntimeServiceImpl(ProcessEngineConfigurationImpl configuration) {
<span class="nc" id="L126">        super(configuration);</span>
<span class="nc" id="L127">    }</span>

    @Override
    public ProcessInstance startProcessInstanceByKey(String processDefinitionKey) {
<span class="nc" id="L131">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(processDefinitionKey, null, null, null));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByKey(String processDefinitionKey, String businessKey) {
<span class="nc" id="L136">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(processDefinitionKey, null, businessKey, null));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByKey(String processDefinitionKey, Map&lt;String, Object&gt; variables) {
<span class="nc" id="L141">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(processDefinitionKey, null, null, variables));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByKey(String processDefinitionKey, String businessKey, Map&lt;String, Object&gt; variables) {
<span class="nc" id="L146">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(processDefinitionKey, null, businessKey, variables));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByKeyAndTenantId(String processDefinitionKey, String tenantId) {
<span class="nc" id="L151">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(processDefinitionKey, null, null, null, tenantId));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByKeyAndTenantId(String processDefinitionKey, String businessKey, String tenantId) {
<span class="nc" id="L156">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(processDefinitionKey, null, businessKey, null, tenantId));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByKeyAndTenantId(String processDefinitionKey, Map&lt;String, Object&gt; variables, String tenantId) {
<span class="nc" id="L161">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(processDefinitionKey, null, null, variables, tenantId));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByKeyAndTenantId(String processDefinitionKey, String businessKey, Map&lt;String, Object&gt; variables, String tenantId) {
<span class="nc" id="L166">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(processDefinitionKey, null, businessKey, variables, tenantId));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceById(String processDefinitionId) {
<span class="nc" id="L171">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(null, processDefinitionId, null, null));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceById(String processDefinitionId, String businessKey) {
<span class="nc" id="L176">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(null, processDefinitionId, businessKey, null));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceById(String processDefinitionId, Map&lt;String, Object&gt; variables) {
<span class="nc" id="L181">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(null, processDefinitionId, null, variables));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceById(String processDefinitionId, String businessKey, Map&lt;String, Object&gt; variables) {
<span class="nc" id="L186">        return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(null, processDefinitionId, businessKey, variables));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceWithForm(String processDefinitionId, String outcome, Map&lt;String, Object&gt; variables, String processInstanceName) {
<span class="nc" id="L191">        ProcessInstanceBuilder processInstanceBuilder = createProcessInstanceBuilder()</span>
<span class="nc" id="L192">            .processDefinitionId(processDefinitionId)</span>
<span class="nc" id="L193">            .outcome(outcome)</span>
<span class="nc" id="L194">            .startFormVariables(variables)</span>
<span class="nc" id="L195">            .name(processInstanceName);</span>
<span class="nc" id="L196">        return processInstanceBuilder.start();</span>
    }

    @Override
    public FormInfo getStartFormModel(String processDefinitionId, String processInstanceId) {
<span class="nc" id="L201">        return commandExecutor.execute(new GetStartFormModelCmd(processDefinitionId, processInstanceId));</span>
    }

    @Override
    public void deleteProcessInstance(String processInstanceId, String deleteReason) {
<span class="nc" id="L206">        commandExecutor.execute(new DeleteProcessInstanceCmd(processInstanceId, deleteReason));</span>
<span class="nc" id="L207">    }</span>

    @Override
    public void bulkDeleteProcessInstances(Collection&lt;String&gt; processInstanceIds, String deleteReason) {
<span class="nc" id="L211">        commandExecutor.execute(new DeleteProcessInstancesByIdCmd(processInstanceIds, deleteReason));</span>
<span class="nc" id="L212">    }</span>

    @Override
    public ExecutionQuery createExecutionQuery() {
<span class="nc" id="L216">        return new ExecutionQueryImpl(commandExecutor, configuration);</span>
    }

    @Override
    public NativeExecutionQuery createNativeExecutionQuery() {
<span class="nc" id="L221">        return new NativeExecutionQueryImpl(commandExecutor);</span>
    }

    @Override
    public NativeProcessInstanceQuery createNativeProcessInstanceQuery() {
<span class="nc" id="L226">        return new NativeProcessInstanceQueryImpl(commandExecutor);</span>
    }

    @Override
    public NativeActivityInstanceQueryImpl createNativeActivityInstanceQuery() {
<span class="nc" id="L231">        return new NativeActivityInstanceQueryImpl(commandExecutor);</span>
    }

    @Override
    public EventSubscriptionQuery createEventSubscriptionQuery() {
<span class="nc" id="L236">        return new EventSubscriptionQueryImpl(commandExecutor, configuration.getEventSubscriptionServiceConfiguration());</span>
    }

    @Override
    public void updateBusinessKey(String processInstanceId, String businessKey) {
<span class="nc" id="L241">        commandExecutor.execute(new SetProcessInstanceBusinessKeyCmd(processInstanceId, businessKey));</span>
<span class="nc" id="L242">    }</span>
    
    @Override
    public void updateBusinessStatus(String processInstanceId, String businessStatus) {
<span class="nc" id="L246">        commandExecutor.execute(new SetProcessInstanceBusinessStatusCmd(processInstanceId, businessStatus));</span>
<span class="nc" id="L247">    }</span>

    @Override
    public Map&lt;String, Object&gt; getVariables(String executionId) {
<span class="nc" id="L251">        return commandExecutor.execute(new GetExecutionVariablesCmd(executionId, null, false));</span>
    }

    @Override
    public Map&lt;String, VariableInstance&gt; getVariableInstances(String executionId) {
<span class="nc" id="L256">        return commandExecutor.execute(new GetExecutionVariableInstancesCmd(executionId, null, false));</span>
    }

    @Override
    public List&lt;VariableInstance&gt; getVariableInstancesByExecutionIds(Set&lt;String&gt; executionIds) {
<span class="nc" id="L261">        return commandExecutor.execute(new GetExecutionsVariablesCmd(executionIds));</span>
    }

    @Override
    public Map&lt;String, Object&gt; getVariablesLocal(String executionId) {
<span class="nc" id="L266">        return commandExecutor.execute(new GetExecutionVariablesCmd(executionId, null, true));</span>
    }

    @Override
    public Map&lt;String, VariableInstance&gt; getVariableInstancesLocal(String executionId) {
<span class="nc" id="L271">        return commandExecutor.execute(new GetExecutionVariableInstancesCmd(executionId, null, true));</span>
    }

    @Override
    public Map&lt;String, Object&gt; getVariables(String executionId, Collection&lt;String&gt; variableNames) {
<span class="nc" id="L276">        return commandExecutor.execute(new GetExecutionVariablesCmd(executionId, variableNames, false));</span>
    }

    @Override
    public Map&lt;String, VariableInstance&gt; getVariableInstances(String executionId, Collection&lt;String&gt; variableNames) {
<span class="nc" id="L281">        return commandExecutor.execute(new GetExecutionVariableInstancesCmd(executionId, variableNames, false));</span>
    }

    @Override
    public Map&lt;String, Object&gt; getVariablesLocal(String executionId, Collection&lt;String&gt; variableNames) {
<span class="nc" id="L286">        return commandExecutor.execute(new GetExecutionVariablesCmd(executionId, variableNames, true));</span>
    }

    @Override
    public Map&lt;String, VariableInstance&gt; getVariableInstancesLocal(String executionId, Collection&lt;String&gt; variableNames) {
<span class="nc" id="L291">        return commandExecutor.execute(new GetExecutionVariableInstancesCmd(executionId, variableNames, true));</span>
    }

    @Override
    public Object getVariable(String executionId, String variableName) {
<span class="nc" id="L296">        return commandExecutor.execute(new GetExecutionVariableCmd(executionId, variableName, false));</span>
    }

    @Override
    public VariableInstance getVariableInstance(String executionId, String variableName) {
<span class="nc" id="L301">        return commandExecutor.execute(new GetExecutionVariableInstanceCmd(executionId, variableName, false));</span>
    }

    @Override
    public &lt;T&gt; T getVariable(String executionId, String variableName, Class&lt;T&gt; variableClass) {
<span class="nc" id="L306">        return variableClass.cast(getVariable(executionId, variableName));</span>
    }

    @Override
    public boolean hasVariable(String executionId, String variableName) {
<span class="nc" id="L311">        return commandExecutor.execute(new HasExecutionVariableCmd(executionId, variableName, false));</span>
    }

    @Override
    public Object getVariableLocal(String executionId, String variableName) {
<span class="nc" id="L316">        return commandExecutor.execute(new GetExecutionVariableCmd(executionId, variableName, true));</span>
    }

    @Override
    public VariableInstance getVariableInstanceLocal(String executionId, String variableName) {
<span class="nc" id="L321">        return commandExecutor.execute(new GetExecutionVariableInstanceCmd(executionId, variableName, true));</span>
    }

    @Override
    public &lt;T&gt; T getVariableLocal(String executionId, String variableName, Class&lt;T&gt; variableClass) {
<span class="nc" id="L326">        return variableClass.cast(getVariableLocal(executionId, variableName));</span>
    }

    @Override
    public boolean hasVariableLocal(String executionId, String variableName) {
<span class="nc" id="L331">        return commandExecutor.execute(new HasExecutionVariableCmd(executionId, variableName, true));</span>
    }

    @Override
    public void setVariable(String executionId, String variableName, Object value) {
<span class="nc bnc" id="L336" title="All 2 branches missed.">        if (variableName == null) {</span>
<span class="nc" id="L337">            throw new FlowableIllegalArgumentException(&quot;variableName is null&quot;);</span>
        }
<span class="nc" id="L339">        Map&lt;String, Object&gt; variables = new HashMap&lt;&gt;();</span>
<span class="nc" id="L340">        variables.put(variableName, value);</span>
<span class="nc" id="L341">        commandExecutor.execute(new SetExecutionVariablesCmd(executionId, variables, false));</span>
<span class="nc" id="L342">    }</span>

    @Override
    public void setVariableLocal(String executionId, String variableName, Object value) {
<span class="nc bnc" id="L346" title="All 2 branches missed.">        if (variableName == null) {</span>
<span class="nc" id="L347">            throw new FlowableIllegalArgumentException(&quot;variableName is null&quot;);</span>
        }
<span class="nc" id="L349">        Map&lt;String, Object&gt; variables = new HashMap&lt;&gt;();</span>
<span class="nc" id="L350">        variables.put(variableName, value);</span>
<span class="nc" id="L351">        commandExecutor.execute(new SetExecutionVariablesCmd(executionId, variables, true));</span>
<span class="nc" id="L352">    }</span>

    @Override
    public void setVariables(String executionId, Map&lt;String, ?&gt; variables) {
<span class="nc" id="L356">        commandExecutor.execute(new SetExecutionVariablesCmd(executionId, variables, false));</span>
<span class="nc" id="L357">    }</span>

    @Override
    public void setVariablesLocal(String executionId, Map&lt;String, ?&gt; variables) {
<span class="nc" id="L361">        commandExecutor.execute(new SetExecutionVariablesCmd(executionId, variables, true));</span>
<span class="nc" id="L362">    }</span>

    @Override
    public void removeVariable(String executionId, String variableName) {
<span class="nc" id="L366">        Collection&lt;String&gt; variableNames = new ArrayList&lt;&gt;(1);</span>
<span class="nc" id="L367">        variableNames.add(variableName);</span>
<span class="nc" id="L368">        commandExecutor.execute(new RemoveExecutionVariablesCmd(executionId, variableNames, false));</span>
<span class="nc" id="L369">    }</span>

    @Override
    public void removeVariableLocal(String executionId, String variableName) {
<span class="nc" id="L373">        Collection&lt;String&gt; variableNames = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L374">        variableNames.add(variableName);</span>
<span class="nc" id="L375">        commandExecutor.execute(new RemoveExecutionVariablesCmd(executionId, variableNames, true));</span>
<span class="nc" id="L376">    }</span>

    @Override
    public void removeVariables(String executionId, Collection&lt;String&gt; variableNames) {
<span class="nc" id="L380">        commandExecutor.execute(new RemoveExecutionVariablesCmd(executionId, variableNames, false));</span>
<span class="nc" id="L381">    }</span>

    @Override
    public void removeVariablesLocal(String executionId, Collection&lt;String&gt; variableNames) {
<span class="nc" id="L385">        commandExecutor.execute(new RemoveExecutionVariablesCmd(executionId, variableNames, true));</span>
<span class="nc" id="L386">    }</span>
    
    @Override
    public VariableInstanceQuery createVariableInstanceQuery() {
<span class="nc" id="L390">        return new VariableInstanceQueryImpl(commandExecutor, configuration.getVariableServiceConfiguration());</span>
    }

    @Override
    public NativeVariableInstanceQuery createNativeVariableInstanceQuery() {
<span class="nc" id="L395">        return new NativeVariableInstanceQueryImpl(commandExecutor, configuration.getVariableServiceConfiguration());</span>
    }

    @Override
    public Map&lt;String, DataObject&gt; getDataObjects(String executionId) {
<span class="nc" id="L400">        return commandExecutor.execute(new GetDataObjectsCmd(executionId, null, false));</span>
    }

    @Override
    public Map&lt;String, DataObject&gt; getDataObjects(String executionId, String locale, boolean withLocalizationFallback) {
<span class="nc" id="L405">        return commandExecutor.execute(new GetDataObjectsCmd(executionId, null, false, locale, withLocalizationFallback));</span>
    }

    @Override
    public Map&lt;String, DataObject&gt; getDataObjectsLocal(String executionId) {
<span class="nc" id="L410">        return commandExecutor.execute(new GetDataObjectsCmd(executionId, null, true));</span>
    }

    @Override
    public Map&lt;String, DataObject&gt; getDataObjectsLocal(String executionId, String locale, boolean withLocalizationFallback) {
<span class="nc" id="L415">        return commandExecutor.execute(new GetDataObjectsCmd(executionId, null, true, locale, withLocalizationFallback));</span>
    }

    @Override
    public Map&lt;String, DataObject&gt; getDataObjects(String executionId, Collection&lt;String&gt; dataObjectNames) {
<span class="nc" id="L420">        return commandExecutor.execute(new GetDataObjectsCmd(executionId, dataObjectNames, false));</span>
    }

    @Override
    public Map&lt;String, DataObject&gt; getDataObjects(String executionId, Collection&lt;String&gt; dataObjectNames, String locale, boolean withLocalizationFallback) {
<span class="nc" id="L425">        return commandExecutor.execute(new GetDataObjectsCmd(executionId, dataObjectNames, false, locale, withLocalizationFallback));</span>
    }

    @Override
    public Map&lt;String, DataObject&gt; getDataObjectsLocal(String executionId, Collection&lt;String&gt; dataObjects) {
<span class="nc" id="L430">        return commandExecutor.execute(new GetDataObjectsCmd(executionId, dataObjects, true));</span>
    }

    @Override
    public Map&lt;String, DataObject&gt; getDataObjectsLocal(String executionId, Collection&lt;String&gt; dataObjectNames, String locale, boolean withLocalizationFallback) {
<span class="nc" id="L435">        return commandExecutor.execute(new GetDataObjectsCmd(executionId, dataObjectNames, true, locale, withLocalizationFallback));</span>
    }

    @Override
    public DataObject getDataObject(String executionId, String dataObject) {
<span class="nc" id="L440">        return commandExecutor.execute(new GetDataObjectCmd(executionId, dataObject, false));</span>
    }

    @Override
    public DataObject getDataObject(String executionId, String dataObjectName, String locale, boolean withLocalizationFallback) {
<span class="nc" id="L445">        return commandExecutor.execute(new GetDataObjectCmd(executionId, dataObjectName, false, locale, withLocalizationFallback));</span>
    }

    @Override
    public DataObject getDataObjectLocal(String executionId, String dataObjectName) {
<span class="nc" id="L450">        return commandExecutor.execute(new GetDataObjectCmd(executionId, dataObjectName, true));</span>
    }

    @Override
    public DataObject getDataObjectLocal(String executionId, String dataObjectName, String locale, boolean withLocalizationFallback) {
<span class="nc" id="L455">        return commandExecutor.execute(new GetDataObjectCmd(executionId, dataObjectName, true, locale, withLocalizationFallback));</span>
    }

    public void signal(String executionId) {
<span class="nc" id="L459">        commandExecutor.execute(new TriggerCmd(executionId, null));</span>
<span class="nc" id="L460">    }</span>

    @Override
    public void trigger(String executionId) {
<span class="nc" id="L464">        commandExecutor.execute(new TriggerCmd(executionId, null));</span>
<span class="nc" id="L465">    }</span>

    @Override
    public void triggerAsync(String executionId) {
<span class="nc" id="L469">        commandExecutor.execute(new TriggerCmd(executionId, null, true));</span>
<span class="nc" id="L470">    }</span>

    public void signal(String executionId, Map&lt;String, Object&gt; processVariables) {
<span class="nc" id="L473">        commandExecutor.execute(new TriggerCmd(executionId, processVariables));</span>
<span class="nc" id="L474">    }</span>

    @Override
    public void trigger(String executionId, Map&lt;String, Object&gt; processVariables) {
<span class="nc" id="L478">        commandExecutor.execute(new TriggerCmd(executionId, processVariables));</span>
<span class="nc" id="L479">    }</span>

    @Override
    public void triggerAsync(String executionId, Map&lt;String, Object&gt; processVariables) {
<span class="nc" id="L483">        commandExecutor.execute(new TriggerCmd(executionId, processVariables, true));</span>
<span class="nc" id="L484">    }</span>

    @Override
    public void trigger(String executionId, Map&lt;String, Object&gt; processVariables, Map&lt;String, Object&gt; transientVariables) {
<span class="nc" id="L488">        commandExecutor.execute(new TriggerCmd(executionId, processVariables, transientVariables));</span>
<span class="nc" id="L489">    }</span>
    
    @Override
    public void evaluateConditionalEvents(String processInstanceId) {
<span class="nc" id="L493">        commandExecutor.execute(new EvaluateConditionalEventsCmd(processInstanceId, null));</span>
<span class="nc" id="L494">    }</span>

    @Override
    public void evaluateConditionalEvents(String processInstanceId, Map&lt;String, Object&gt; processVariables) {
<span class="nc" id="L498">        commandExecutor.execute(new EvaluateConditionalEventsCmd(processInstanceId, processVariables));</span>
<span class="nc" id="L499">    }</span>

    @Override
    public void setOwner(String processInstanceId, String userId) {
<span class="nc" id="L503">        commandExecutor.execute(new SetProcessInstanceOwnerCmd(processInstanceId, userId));</span>
<span class="nc" id="L504">    }</span>

    @Override
    public void removeOwner(String processInstanceId) {
<span class="nc" id="L508">        commandExecutor.execute(new RemoveProcessInstanceOwnerCmd(processInstanceId));</span>
<span class="nc" id="L509">    }</span>

    @Override
    public void setAssignee(String processInstanceId, String userId) {
<span class="nc" id="L513">        commandExecutor.execute(new SetProcessInstanceAssigneeCmd(processInstanceId, userId));</span>
<span class="nc" id="L514">    }</span>

    @Override
    public void removeAssignee(String processInstanceId) {
<span class="nc" id="L518">        commandExecutor.execute(new RemoveProcessInstanceAssigneeCmd(processInstanceId));</span>
<span class="nc" id="L519">    }</span>

    @Override
    public void addUserIdentityLink(String processInstanceId, String userId, String identityLinkType) {
<span class="nc" id="L523">        commandExecutor.execute(new AddIdentityLinkForProcessInstanceCmd(processInstanceId, userId, null, identityLinkType));</span>
<span class="nc" id="L524">    }</span>

    @Override
    public void addGroupIdentityLink(String processInstanceId, String groupId, String identityLinkType) {
<span class="nc" id="L528">        commandExecutor.execute(new AddIdentityLinkForProcessInstanceCmd(processInstanceId, null, groupId, identityLinkType));</span>
<span class="nc" id="L529">    }</span>

    @Override
    public void addParticipantUser(String processInstanceId, String userId) {
<span class="nc" id="L533">        commandExecutor.execute(new AddIdentityLinkForProcessInstanceCmd(processInstanceId, userId, null, IdentityLinkType.PARTICIPANT));</span>
<span class="nc" id="L534">    }</span>

    @Override
    public void addParticipantGroup(String processInstanceId, String groupId) {
<span class="nc" id="L538">        commandExecutor.execute(new AddIdentityLinkForProcessInstanceCmd(processInstanceId, null, groupId, IdentityLinkType.PARTICIPANT));</span>
<span class="nc" id="L539">    }</span>

    @Override
    public void deleteParticipantUser(String processInstanceId, String userId) {
<span class="nc" id="L543">        commandExecutor.execute(new DeleteIdentityLinkForProcessInstanceCmd(processInstanceId, userId, null, IdentityLinkType.PARTICIPANT));</span>
<span class="nc" id="L544">    }</span>

    @Override
    public void deleteParticipantGroup(String processInstanceId, String groupId) {
<span class="nc" id="L548">        commandExecutor.execute(new DeleteIdentityLinkForProcessInstanceCmd(processInstanceId, null, groupId, IdentityLinkType.PARTICIPANT));</span>
<span class="nc" id="L549">    }</span>

    @Override
    public void deleteUserIdentityLink(String processInstanceId, String userId, String identityLinkType) {
<span class="nc" id="L553">        commandExecutor.execute(new DeleteIdentityLinkForProcessInstanceCmd(processInstanceId, userId, null, identityLinkType));</span>
<span class="nc" id="L554">    }</span>

    @Override
    public void deleteGroupIdentityLink(String processInstanceId, String groupId, String identityLinkType) {
<span class="nc" id="L558">        commandExecutor.execute(new DeleteIdentityLinkForProcessInstanceCmd(processInstanceId, null, groupId, identityLinkType));</span>
<span class="nc" id="L559">    }</span>

    @Override
    public List&lt;IdentityLink&gt; getIdentityLinksForProcessInstance(String processInstanceId) {
<span class="nc" id="L563">        return commandExecutor.execute(new GetIdentityLinksForProcessInstanceCmd(processInstanceId));</span>
    }

    @Override
    public List&lt;EntityLink&gt; getEntityLinkChildrenForProcessInstance(String processInstanceId) {
<span class="nc" id="L568">        return commandExecutor.execute(new GetEntityLinkChildrenForProcessInstanceCmd(processInstanceId));</span>
    }

    @Override
    public List&lt;EntityLink&gt; getEntityLinkChildrenWithSameRootAsProcessInstance(String processInstanceId) {
<span class="nc" id="L573">        return commandExecutor.execute(new GetEntityLinkChildrenWithSameRootAsProcessInstanceCmd(processInstanceId));</span>
    }

    @Override
    public List&lt;EntityLink&gt; getEntityLinkChildrenForTask(String taskId) {
<span class="nc" id="L578">        return commandExecutor.execute(new GetEntityLinkChildrenForTaskCmd(taskId));</span>
    }

    @Override
    public List&lt;EntityLink&gt; getEntityLinkParentsForProcessInstance(String processInstanceId) {
<span class="nc" id="L583">        return commandExecutor.execute(new GetEntityLinkParentsForProcessInstanceCmd(processInstanceId));</span>
    }

    @Override
    public List&lt;EntityLink&gt; getEntityLinkParentsForTask(String taskId) {
<span class="nc" id="L588">        return commandExecutor.execute(new GetEntityLinkParentsForTaskCmd(taskId));</span>
    }

    @Override
    public ProcessInstanceQuery createProcessInstanceQuery() {
<span class="nc" id="L593">        return new ProcessInstanceQueryImpl(commandExecutor, configuration);</span>
    }

    @Override
    public ActivityInstanceQueryImpl createActivityInstanceQuery() {
<span class="nc" id="L598">        return new ActivityInstanceQueryImpl(commandExecutor);</span>
    }

    @Override
    public List&lt;String&gt; getActiveActivityIds(String executionId) {
<span class="nc" id="L603">        return commandExecutor.execute(new FindActiveActivityIdsCmd(executionId));</span>
    }

    public FormData getFormInstanceById(String processDefinitionId) {
<span class="nc" id="L607">        return commandExecutor.execute(new GetStartFormCmd(processDefinitionId));</span>
    }

    @Override
    public void suspendProcessInstanceById(String processInstanceId) {
<span class="nc" id="L612">        commandExecutor.execute(new SuspendProcessInstanceCmd(processInstanceId));</span>
<span class="nc" id="L613">    }</span>

    @Override
    public void activateProcessInstanceById(String processInstanceId) {
<span class="nc" id="L617">        commandExecutor.execute(new ActivateProcessInstanceCmd(processInstanceId));</span>
<span class="nc" id="L618">    }</span>

    @Override
    public ProcessInstance startProcessInstanceByMessage(String messageName) {
<span class="nc" id="L622">        return commandExecutor.execute(new StartProcessInstanceByMessageCmd(messageName, null, null, null));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByMessageAndTenantId(String messageName, String tenantId) {
<span class="nc" id="L627">        return commandExecutor.execute(new StartProcessInstanceByMessageCmd(messageName, null, null, tenantId));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByMessage(String messageName, String businessKey) {
<span class="nc" id="L632">        return commandExecutor.execute(new StartProcessInstanceByMessageCmd(messageName, businessKey, null, null));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByMessageAndTenantId(String messageName, String businessKey, String tenantId) {
<span class="nc" id="L637">        return commandExecutor.execute(new StartProcessInstanceByMessageCmd(messageName, businessKey, null, tenantId));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByMessage(String messageName, Map&lt;String, Object&gt; processVariables) {
<span class="nc" id="L642">        return commandExecutor.execute(new StartProcessInstanceByMessageCmd(messageName, null, processVariables, null));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByMessageAndTenantId(String messageName, Map&lt;String, Object&gt; processVariables, String tenantId) {
<span class="nc" id="L647">        return commandExecutor.execute(new StartProcessInstanceByMessageCmd(messageName, null, processVariables, tenantId));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByMessage(String messageName, String businessKey, Map&lt;String, Object&gt; processVariables) {
<span class="nc" id="L652">        return commandExecutor.execute(new StartProcessInstanceByMessageCmd(messageName, businessKey, processVariables, null));</span>
    }

    @Override
    public ProcessInstance startProcessInstanceByMessageAndTenantId(String messageName, String businessKey, Map&lt;String, Object&gt; processVariables, String tenantId) {
<span class="nc" id="L657">        return commandExecutor.execute(new StartProcessInstanceByMessageCmd(messageName, businessKey, processVariables, tenantId));</span>
    }

    @Override
    public void signalEventReceived(String signalName) {
<span class="nc" id="L662">        commandExecutor.execute(new SignalEventReceivedCmd(signalName, null, null, null));</span>
<span class="nc" id="L663">    }</span>

    @Override
    public void signalEventReceivedWithTenantId(String signalName, String tenantId) {
<span class="nc" id="L667">        commandExecutor.execute(new SignalEventReceivedCmd(signalName, null, null, tenantId));</span>
<span class="nc" id="L668">    }</span>

    @Override
    public void signalEventReceivedAsync(String signalName) {
<span class="nc" id="L672">        commandExecutor.execute(new SignalEventReceivedCmd(signalName, null, true, null));</span>
<span class="nc" id="L673">    }</span>

    @Override
    public void signalEventReceivedAsyncWithTenantId(String signalName, String tenantId) {
<span class="nc" id="L677">        commandExecutor.execute(new SignalEventReceivedCmd(signalName, null, true, tenantId));</span>
<span class="nc" id="L678">    }</span>

    @Override
    public void signalEventReceived(String signalName, Map&lt;String, Object&gt; processVariables) {
<span class="nc" id="L682">        commandExecutor.execute(new SignalEventReceivedCmd(signalName, null, processVariables, null));</span>
<span class="nc" id="L683">    }</span>

    @Override
    public void signalEventReceivedWithTenantId(String signalName, Map&lt;String, Object&gt; processVariables, String tenantId) {
<span class="nc" id="L687">        commandExecutor.execute(new SignalEventReceivedCmd(signalName, null, processVariables, tenantId));</span>
<span class="nc" id="L688">    }</span>

    @Override
    public void signalEventReceived(String signalName, String executionId) {
<span class="nc" id="L692">        commandExecutor.execute(new SignalEventReceivedCmd(signalName, executionId, null, null));</span>
<span class="nc" id="L693">    }</span>

    @Override
    public void signalEventReceived(String signalName, String executionId, Map&lt;String, Object&gt; processVariables) {
<span class="nc" id="L697">        commandExecutor.execute(new SignalEventReceivedCmd(signalName, executionId, processVariables, null));</span>
<span class="nc" id="L698">    }</span>

    @Override
    public void signalEventReceivedAsync(String signalName, String executionId) {
<span class="nc" id="L702">        commandExecutor.execute(new SignalEventReceivedCmd(signalName, executionId, true, null));</span>
<span class="nc" id="L703">    }</span>

    @Override
    public void messageEventReceived(String messageName, String executionId) {
<span class="nc" id="L707">        commandExecutor.execute(new MessageEventReceivedCmd(messageName, executionId, null));</span>
<span class="nc" id="L708">    }</span>

    @Override
    public void messageEventReceived(String messageName, String executionId, Map&lt;String, Object&gt; processVariables) {
<span class="nc" id="L712">        commandExecutor.execute(new MessageEventReceivedCmd(messageName, executionId, processVariables));</span>
<span class="nc" id="L713">    }</span>

    @Override
    public void messageEventReceivedAsync(String messageName, String executionId) {
<span class="nc" id="L717">        commandExecutor.execute(new MessageEventReceivedCmd(messageName, executionId, true));</span>
<span class="nc" id="L718">    }</span>

    @Override
    public void addEventListener(FlowableEventListener listenerToAdd) {
<span class="nc" id="L722">        commandExecutor.execute(new AddEventListenerCommand(listenerToAdd));</span>
<span class="nc" id="L723">    }</span>

    @Override
    public void addEventListener(FlowableEventListener listenerToAdd, FlowableEngineEventType... types) {
<span class="nc" id="L727">        commandExecutor.execute(new AddEventListenerCommand(listenerToAdd, types));</span>
<span class="nc" id="L728">    }</span>

    @Override
    public void removeEventListener(FlowableEventListener listenerToRemove) {
<span class="nc" id="L732">        commandExecutor.execute(new RemoveEventListenerCommand(listenerToRemove));</span>
<span class="nc" id="L733">    }</span>

    @Override
    public void dispatchEvent(FlowableEvent event) {
<span class="nc" id="L737">        commandExecutor.execute(new DispatchEventCommand(event));</span>
<span class="nc" id="L738">    }</span>
    
    @Override
    public void addEventRegistryConsumer(EventRegistryEventConsumer eventConsumer) {
<span class="nc" id="L742">        commandExecutor.execute(new AddEventConsumerCommand(eventConsumer));</span>
<span class="nc" id="L743">    }</span>
    
    @Override
    public void removeEventRegistryConsumer(EventRegistryEventConsumer eventConsumer) {
<span class="nc" id="L747">        commandExecutor.execute(new RemoveEventConsumerCommand(eventConsumer));</span>
<span class="nc" id="L748">    }</span>

    @Override
    public ProcessInstanceStartEventSubscriptionBuilder createProcessInstanceStartEventSubscriptionBuilder() {
<span class="nc" id="L752">        return new ProcessInstanceStartEventSubscriptionBuilderImpl(this);</span>
    }

    @Override
    public ProcessInstanceStartEventSubscriptionModificationBuilder createProcessInstanceStartEventSubscriptionModificationBuilder() {
<span class="nc" id="L757">        return new ProcessInstanceStartEventSubscriptionModificationBuilderImpl(this);</span>
    }

    @Override
    public ProcessInstanceStartEventSubscriptionDeletionBuilder createProcessInstanceStartEventSubscriptionDeletionBuilder() {
<span class="nc" id="L762">        return new ProcessInstanceStartEventSubscriptionDeletionBuilderImpl(this);</span>
    }

    @Override
    public void setProcessInstanceName(String processInstanceId, String name) {
<span class="nc" id="L767">        commandExecutor.execute(new SetProcessInstanceNameCmd(processInstanceId, name));</span>
<span class="nc" id="L768">    }</span>

    @Override
    public List&lt;Event&gt; getProcessInstanceEvents(String processInstanceId) {
<span class="nc" id="L772">        return commandExecutor.execute(new GetProcessInstanceEventsCmd(processInstanceId));</span>
    }

    @Override
    public List&lt;Execution&gt; getAdhocSubProcessExecutions(String processInstanceId) {
<span class="nc" id="L777">        return commandExecutor.execute(new GetActiveAdhocSubProcessesCmd(processInstanceId));</span>
    }

    @Override
    public List&lt;FlowNode&gt; getEnabledActivitiesFromAdhocSubProcess(String executionId) {
<span class="nc" id="L782">        return commandExecutor.execute(new GetEnabledActivitiesForAdhocSubProcessCmd(executionId));</span>
    }

    @Override
    public Execution executeActivityInAdhocSubProcess(String executionId, String activityId) {
<span class="nc" id="L787">        return commandExecutor.execute(new ExecuteActivityForAdhocSubProcessCmd(executionId, activityId));</span>
    }

    @Override
    public void completeAdhocSubProcess(String executionId) {
<span class="nc" id="L792">        commandExecutor.execute(new CompleteAdhocSubProcessCmd(executionId));</span>
<span class="nc" id="L793">    }</span>

    @Override
    public ProcessInstanceBuilder createProcessInstanceBuilder() {
<span class="nc" id="L797">        return new ProcessInstanceBuilderImpl(this);</span>
    }

    @Override
    public ChangeActivityStateBuilder createChangeActivityStateBuilder() {
<span class="nc" id="L802">        return new ChangeActivityStateBuilderImpl(this);</span>
    }

    @Override
    public Execution addMultiInstanceExecution(String activityId, String parentExecutionId, Map&lt;String, Object&gt; executionVariables) {
<span class="nc" id="L807">        return commandExecutor.execute(new AddMultiInstanceExecutionCmd(activityId, parentExecutionId, executionVariables));</span>
    }

    @Override
    public void deleteMultiInstanceExecution(String executionId, boolean executionIsCompleted) {
<span class="nc" id="L812">        commandExecutor.execute(new DeleteMultiInstanceExecutionCmd(executionId, executionIsCompleted));</span>
<span class="nc" id="L813">    }</span>

    public ProcessInstance startProcessInstance(ProcessInstanceBuilderImpl processInstanceBuilder) {
<span class="nc bnc" id="L816" title="All 4 branches missed.">        if (processInstanceBuilder.getProcessDefinitionId() != null || processInstanceBuilder.getProcessDefinitionKey() != null) {</span>
<span class="nc" id="L817">            return commandExecutor.execute(new StartProcessInstanceCmd&lt;ProcessInstance&gt;(processInstanceBuilder));</span>
<span class="nc bnc" id="L818" title="All 2 branches missed.">        } else if (processInstanceBuilder.getMessageName() != null) {</span>
<span class="nc" id="L819">            return commandExecutor.execute(new StartProcessInstanceByMessageCmd(processInstanceBuilder));</span>
        } else {
<span class="nc" id="L821">            throw new FlowableIllegalArgumentException(&quot;No processDefinitionId, processDefinitionKey nor messageName provided&quot;);</span>
        }
    }

    public ProcessInstance startProcessInstanceAsync(ProcessInstanceBuilderImpl processInstanceBuilder) {
<span class="nc bnc" id="L826" title="All 4 branches missed.">        if (processInstanceBuilder.getProcessDefinitionId() != null || processInstanceBuilder.getProcessDefinitionKey() != null) {</span>
<span class="nc" id="L827">            return (ProcessInstance) commandExecutor.execute(new StartProcessInstanceAsyncCmd(processInstanceBuilder));</span>
        } else {
<span class="nc" id="L829">            throw new FlowableIllegalArgumentException(&quot;No processDefinitionId, processDefinitionKey provided&quot;);</span>
        }
    }

    public EventSubscription registerProcessInstanceStartEventSubscription(ProcessInstanceStartEventSubscriptionBuilderImpl builder) {
<span class="nc" id="L834">        return commandExecutor.execute(new RegisterProcessInstanceStartEventSubscriptionCmd(builder));</span>
    }

    public void migrateProcessInstanceStartEventSubscriptionsToProcessDefinitionVersion(ProcessInstanceStartEventSubscriptionModificationBuilderImpl builder) {
<span class="nc" id="L838">        commandExecutor.execute(new ModifyProcessInstanceStartEventSubscriptionCmd(builder));</span>
<span class="nc" id="L839">    }</span>

    public void deleteProcessInstanceStartEventSubscriptions(ProcessInstanceStartEventSubscriptionDeletionBuilderImpl builder) {
<span class="nc" id="L842">        commandExecutor.execute(new DeleteProcessInstanceStartEventSubscriptionCmd(builder));</span>
<span class="nc" id="L843">    }</span>

    public void changeActivityState(ChangeActivityStateBuilderImpl changeActivityStateBuilder) {
<span class="nc" id="L846">        commandExecutor.execute(new ChangeActivityStateCmd(changeActivityStateBuilder));</span>
<span class="nc" id="L847">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>