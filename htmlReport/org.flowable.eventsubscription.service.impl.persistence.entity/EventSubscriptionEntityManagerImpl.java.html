<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EventSubscriptionEntityManagerImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jacoco.exec</a> &gt; <a href="index.source.html" class="el_package">org.flowable.eventsubscription.service.impl.persistence.entity</a> &gt; <span class="el_source">EventSubscriptionEntityManagerImpl.java</span></div><h1>EventSubscriptionEntityManagerImpl.java</h1><pre class="source lang-java linenums">/* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.flowable.eventsubscription.service.impl.persistence.entity;

import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.List;

import org.apache.commons.lang3.StringUtils;
import org.flowable.bpmn.model.Signal;
import org.flowable.common.engine.impl.persistence.entity.AbstractServiceEngineEntityManager;
import org.flowable.eventsubscription.api.EventSubscription;
import org.flowable.eventsubscription.api.EventSubscriptionBuilder;
import org.flowable.eventsubscription.service.EventSubscriptionServiceConfiguration;
import org.flowable.eventsubscription.service.impl.EventSubscriptionQueryImpl;
import org.flowable.eventsubscription.service.impl.persistence.entity.data.EventSubscriptionDataManager;

/**
 * @author Joram Barrez
 * @author Tijs Rademakers
 */
public class EventSubscriptionEntityManagerImpl
    extends AbstractServiceEngineEntityManager&lt;EventSubscriptionServiceConfiguration, EventSubscriptionEntity, EventSubscriptionDataManager&gt;
    implements EventSubscriptionEntityManager {

    public EventSubscriptionEntityManagerImpl(EventSubscriptionServiceConfiguration eventSubscriptionServiceConfiguration, 
                    EventSubscriptionDataManager eventSubscriptionDataManager) {
        
<span class="nc" id="L42">        super(eventSubscriptionServiceConfiguration, eventSubscriptionServiceConfiguration.getEngineName(), eventSubscriptionDataManager);</span>
<span class="nc" id="L43">    }</span>

    @Override
    public CompensateEventSubscriptionEntity createCompensateEventSubscription() {
<span class="nc" id="L47">        return dataManager.createCompensateEventSubscription();</span>
    }

    @Override
    public MessageEventSubscriptionEntity createMessageEventSubscription() {
<span class="nc" id="L52">        return dataManager.createMessageEventSubscription();</span>
    }

    @Override
    public SignalEventSubscriptionEntity createSignalEventSubscription() {
<span class="nc" id="L57">        return dataManager.createSignalEventSubscription();</span>
    }

    @Override
    public GenericEventSubscriptionEntity createGenericEventSubscription() {
<span class="nc" id="L62">        return dataManager.createGenericEventSubscriptionEntity();</span>
    }

    @Override
    public EventSubscription createEventSubscription(EventSubscriptionBuilder eventSubscriptionBuilder) {
<span class="nc bnc" id="L67" title="All 2 branches missed.">        if (SignalEventSubscriptionEntity.EVENT_TYPE.equals(eventSubscriptionBuilder.getEventType())) {</span>
<span class="nc" id="L68">            return insertSignalEvent(eventSubscriptionBuilder);</span>
            
<span class="nc bnc" id="L70" title="All 2 branches missed.">        } else if (MessageEventSubscriptionEntity.EVENT_TYPE.equals(eventSubscriptionBuilder.getEventType())) {</span>
<span class="nc" id="L71">            return insertMessageEvent(eventSubscriptionBuilder);</span>
            
<span class="nc bnc" id="L73" title="All 2 branches missed.">        } else if (CompensateEventSubscriptionEntity.EVENT_TYPE.equals(eventSubscriptionBuilder.getEventType())) {</span>
<span class="nc" id="L74">            return insertCompensationEvent(eventSubscriptionBuilder);</span>
        
        } else {
<span class="nc" id="L77">            return insertGenericEvent(eventSubscriptionBuilder);</span>
        }
    }

    @Override
    public List&lt;CompensateEventSubscriptionEntity&gt; findCompensateEventSubscriptionsByExecutionId(String executionId) {
<span class="nc" id="L83">        return findCompensateEventSubscriptionsByExecutionIdAndActivityId(executionId, null);</span>
    }

    @Override
    public List&lt;CompensateEventSubscriptionEntity&gt; findCompensateEventSubscriptionsByExecutionIdAndActivityId(String executionId, String activityId) {
<span class="nc" id="L88">        List&lt;EventSubscriptionEntity&gt; eventSubscriptions = findEventSubscriptionsByExecutionAndType(executionId, &quot;compensate&quot;);</span>
<span class="nc" id="L89">        List&lt;CompensateEventSubscriptionEntity&gt; result = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">        for (EventSubscriptionEntity eventSubscriptionEntity : eventSubscriptions) {</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">            if (eventSubscriptionEntity instanceof CompensateEventSubscriptionEntity) {</span>
<span class="nc bnc" id="L92" title="All 4 branches missed.">                if (activityId == null || activityId.equals(eventSubscriptionEntity.getActivityId())) {</span>
<span class="nc" id="L93">                    result.add((CompensateEventSubscriptionEntity) eventSubscriptionEntity);</span>
                }
            }
<span class="nc" id="L96">        }</span>
<span class="nc" id="L97">        return result;</span>
    }

    @Override
    public List&lt;CompensateEventSubscriptionEntity&gt; findCompensateEventSubscriptionsByProcessInstanceIdAndActivityId(String processInstanceId, String activityId) {
<span class="nc" id="L102">        List&lt;EventSubscriptionEntity&gt; eventSubscriptions = findEventSubscriptionsByProcessInstanceAndActivityId(processInstanceId, activityId, &quot;compensate&quot;);</span>
<span class="nc" id="L103">        List&lt;CompensateEventSubscriptionEntity&gt; result = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">        for (EventSubscriptionEntity eventSubscriptionEntity : eventSubscriptions) {</span>
<span class="nc" id="L105">            result.add((CompensateEventSubscriptionEntity) eventSubscriptionEntity);</span>
<span class="nc" id="L106">        }</span>
<span class="nc" id="L107">        return result;</span>
    }

    @Override
    public long findEventSubscriptionCountByQueryCriteria(EventSubscriptionQueryImpl eventSubscriptionQueryImpl) {
<span class="nc" id="L112">        return dataManager.findEventSubscriptionCountByQueryCriteria(eventSubscriptionQueryImpl);</span>
    }

    @Override
    public List&lt;EventSubscription&gt; findEventSubscriptionsByQueryCriteria(EventSubscriptionQueryImpl eventSubscriptionQueryImpl) {
<span class="nc" id="L117">        return dataManager.findEventSubscriptionsByQueryCriteria(eventSubscriptionQueryImpl);</span>
    }

    @Override
    public List&lt;MessageEventSubscriptionEntity&gt; findMessageEventSubscriptionsByProcessInstanceAndEventName(String processInstanceId, String eventName) {
<span class="nc" id="L122">        return dataManager.findMessageEventSubscriptionsByProcessInstanceAndEventName(processInstanceId, eventName);</span>
    }

    @Override
    public List&lt;SignalEventSubscriptionEntity&gt; findSignalEventSubscriptionsByEventName(String eventName, String tenantId) {
<span class="nc" id="L127">        return dataManager.findSignalEventSubscriptionsByEventName(eventName, tenantId);</span>
    }

    @Override
    public List&lt;SignalEventSubscriptionEntity&gt; findSignalEventSubscriptionsByProcessInstanceAndEventName(String processInstanceId, String eventName) {
<span class="nc" id="L132">        return dataManager.findSignalEventSubscriptionsByProcessInstanceAndEventName(processInstanceId, eventName);</span>
    }
    
    @Override
    public List&lt;SignalEventSubscriptionEntity&gt; findSignalEventSubscriptionsByScopeAndEventName(String scopeId, String scopeType, String eventName) {
<span class="nc" id="L137">        return dataManager.findSignalEventSubscriptionsByScopeAndEventName(scopeId, scopeType, eventName);</span>
    }

    @Override
    public List&lt;SignalEventSubscriptionEntity&gt; findSignalEventSubscriptionsByNameAndExecution(String name, String executionId) {
<span class="nc" id="L142">        return dataManager.findSignalEventSubscriptionsByNameAndExecution(name, executionId);</span>
    }

    @Override
    public List&lt;EventSubscriptionEntity&gt; findEventSubscriptionsByExecutionAndType(final String executionId, final String type) {
<span class="nc" id="L147">        return dataManager.findEventSubscriptionsByExecutionAndType(executionId, type);</span>
    }
    
    @Override
    public List&lt;EventSubscriptionEntity&gt; findEventSubscriptionsByProcessInstanceAndType(final String processInstanceId, final String type) {
<span class="nc" id="L152">        return dataManager.findEventSubscriptionsByProcessInstanceAndType(processInstanceId, type);</span>
    }

    @Override
    public List&lt;EventSubscriptionEntity&gt; findEventSubscriptionsByProcessInstanceAndActivityId(String processInstanceId, String activityId, String type) {
<span class="nc" id="L157">        return dataManager.findEventSubscriptionsByProcessInstanceAndActivityId(processInstanceId, activityId, type);</span>
    }

    @Override
    public List&lt;EventSubscriptionEntity&gt; findEventSubscriptionsByExecution(final String executionId) {
<span class="nc" id="L162">        return dataManager.findEventSubscriptionsByExecution(executionId);</span>
    }
    
    @Override
    public List&lt;EventSubscriptionEntity&gt; findEventSubscriptionsBySubScopeId(final String subScopeId) {
<span class="nc" id="L167">        return dataManager.findEventSubscriptionsBySubScopeId(subScopeId);</span>
    }

    @Override
    public List&lt;EventSubscriptionEntity&gt; findEventSubscriptionsByTypeAndProcessDefinitionId(String type, String processDefinitionId, String tenantId) {
<span class="nc" id="L172">        return dataManager.findEventSubscriptionsByTypeAndProcessDefinitionId(type, processDefinitionId, tenantId);</span>
    }
    
    @Override
    public List&lt;EventSubscriptionEntity&gt; findEventSubscriptionsByScopeIdAndType(final String scopeId, final String type) {
<span class="nc" id="L177">        return dataManager.findEventSubscriptionsByScopeIdAndType(scopeId, type);</span>
    }

    @Override
    public List&lt;EventSubscriptionEntity&gt; findEventSubscriptionsByName(String type, String eventName, String tenantId) {
<span class="nc" id="L182">        return dataManager.findEventSubscriptionsByName(type, eventName, tenantId);</span>
    }

    @Override
    public List&lt;EventSubscriptionEntity&gt; findEventSubscriptionsByNameAndExecution(String type, String eventName, String executionId) {
<span class="nc" id="L187">        return dataManager.findEventSubscriptionsByNameAndExecution(type, eventName, executionId);</span>
    }

    @Override
    public MessageEventSubscriptionEntity findMessageStartEventSubscriptionByName(String messageName, String tenantId) {
<span class="nc" id="L192">        return dataManager.findMessageStartEventSubscriptionByName(messageName, tenantId);</span>
    }

    @Override
    public void updateEventSubscriptionTenantId(String oldTenantId, String newTenantId) {
<span class="nc" id="L197">        dataManager.updateEventSubscriptionTenantId(oldTenantId, newTenantId);</span>
<span class="nc" id="L198">    }</span>

    @Override
    public void updateEventSubscriptionProcessDefinitionId(String oldProcessDefinitionId, String newProcessDefinitionId, String eventType, String activityId, String scopeDefinitionKey, String configuration) {
<span class="nc" id="L202">        dataManager.updateEventSubscriptionProcessDefinitionId(oldProcessDefinitionId, newProcessDefinitionId, eventType, activityId, scopeDefinitionKey, configuration);</span>
<span class="nc" id="L203">    }</span>

    @Override
    public void updateEventSubscriptionScopeDefinitionId(String oldScopeDefinitionId, String newScopeDefinitionId, String eventType, String scopeDefinitionKey, String configuration) {
<span class="nc" id="L207">        dataManager.updateEventSubscriptionScopeDefinitionId(oldScopeDefinitionId, newScopeDefinitionId, eventType, scopeDefinitionKey, configuration);</span>
<span class="nc" id="L208">    }</span>

    @Override
    public boolean lockEventSubscription(String eventSubscriptionId) {
<span class="nc" id="L212">        EventSubscriptionServiceConfiguration serviceConfiguration = getServiceConfiguration();</span>

<span class="nc" id="L214">        int lockMillis = (int) serviceConfiguration.getEventSubscriptionLockTime().toMillis();</span>
<span class="nc" id="L215">        GregorianCalendar lockCal = new GregorianCalendar();</span>
<span class="nc" id="L216">        lockCal.setTime(serviceConfiguration.getClock().getCurrentTime());</span>
<span class="nc" id="L217">        lockCal.add(Calendar.MILLISECOND, lockMillis);</span>
<span class="nc" id="L218">        Date lockExpirationTime = lockCal.getTime();</span>

<span class="nc" id="L220">        String lockOwner = serviceConfiguration.getLockOwner();</span>

<span class="nc" id="L222">        return dataManager.updateEventSubscriptionLockTime(eventSubscriptionId, lockExpirationTime, lockOwner, getClock().getCurrentTime());</span>
    }

    @Override
    public void unlockEventSubscription(String eventSubscriptionId) {
<span class="nc" id="L227">        dataManager.clearEventSubscriptionLockTime(eventSubscriptionId);</span>
<span class="nc" id="L228">    }</span>

    @Override
    public void deleteEventSubscriptionsForProcessDefinition(String processDefinitionId) {
<span class="nc" id="L232">        dataManager.deleteEventSubscriptionsForProcessDefinition(processDefinitionId);</span>
<span class="nc" id="L233">    }</span>

    @Override
    public void deleteEventSubscriptionsByExecutionId(String executionId) {
<span class="nc" id="L237">        dataManager.deleteEventSubscriptionsByExecutionId(executionId);</span>
<span class="nc" id="L238">    }</span>
    
    @Override
    public void deleteEventSubscriptionsForScopeIdAndType(String scopeId, String scopeType) {
<span class="nc" id="L242">        dataManager.deleteEventSubscriptionsForScopeIdAndType(scopeId, scopeType);</span>
<span class="nc" id="L243">    }</span>

    @Override
    public void deleteEventSubscriptionsForScopeDefinitionIdAndType(String scopeDefinitionId, String scopeType) {
<span class="nc" id="L247">        dataManager.deleteEventSubscriptionsForScopeDefinitionIdAndType(scopeDefinitionId, scopeType);</span>
<span class="nc" id="L248">    }</span>

    @Override
    public void deleteEventSubscriptionsForScopeDefinitionIdAndTypeAndNullScopeId(String scopeDefinitionId, String scopeType) {
<span class="nc" id="L252">        dataManager.deleteEventSubscriptionsForScopeDefinitionIdAndTypeAndNullScopeId(scopeDefinitionId, scopeType);</span>
<span class="nc" id="L253">    }</span>

    @Override
    public void deleteEventSubscriptionsForProcessDefinitionAndProcessStartEvent(String processDefinitionId, String eventType, String activityId, String configuration) {
<span class="nc" id="L257">        dataManager.deleteEventSubscriptionsForProcessDefinitionAndProcessStartEvent(processDefinitionId, eventType, activityId, configuration);</span>
<span class="nc" id="L258">    }</span>

    @Override
    public void deleteEventSubscriptionsForScopeDefinitionAndScopeStartEvent(String scopeDefinitionId, String eventType, String configuration) {
<span class="nc" id="L262">        dataManager.deleteEventSubscriptionsForScopeDefinitionAndScopeStartEvent(scopeDefinitionId, eventType, configuration);</span>
<span class="nc" id="L263">    }</span>

    protected SignalEventSubscriptionEntity insertSignalEvent(EventSubscriptionBuilder eventSubscriptionBuilder) {
<span class="nc" id="L266">        SignalEventSubscriptionEntity subscriptionEntity = createSignalEventSubscription();</span>
<span class="nc" id="L267">        subscriptionEntity.setExecutionId(eventSubscriptionBuilder.getExecutionId());</span>
<span class="nc" id="L268">        subscriptionEntity.setProcessInstanceId(eventSubscriptionBuilder.getProcessInstanceId());</span>
<span class="nc" id="L269">        subscriptionEntity.setEventName(eventSubscriptionBuilder.getEventName());</span>

<span class="nc" id="L271">        Signal signal = eventSubscriptionBuilder.getSignal();</span>
<span class="nc bnc" id="L272" title="All 2 branches missed.">        if (signal != null) {</span>

            // Eventname set by the builder has precedence
<span class="nc bnc" id="L275" title="All 2 branches missed.">            if (eventSubscriptionBuilder.getEventName() == null) {</span>
<span class="nc bnc" id="L276" title="All 2 branches missed.">                if (StringUtils.isNotEmpty(signal.getName())) {</span>
<span class="nc" id="L277">                    subscriptionEntity.setEventName(signal.getName());</span>
                } else {
<span class="nc" id="L279">                    subscriptionEntity.setEventName(signal.getId());</span>
                }
            }

<span class="nc bnc" id="L283" title="All 2 branches missed.">            if (signal.getScope() != null) {</span>
<span class="nc" id="L284">                subscriptionEntity.setConfiguration(signal.getScope());</span>
            }

        }

<span class="nc" id="L289">        subscriptionEntity.setActivityId(eventSubscriptionBuilder.getActivityId());</span>
<span class="nc" id="L290">        subscriptionEntity.setProcessDefinitionId(eventSubscriptionBuilder.getProcessDefinitionId());</span>
<span class="nc" id="L291">        subscriptionEntity.setSubScopeId(eventSubscriptionBuilder.getSubScopeId());</span>
<span class="nc" id="L292">        subscriptionEntity.setScopeId(eventSubscriptionBuilder.getScopeId());</span>
<span class="nc" id="L293">        subscriptionEntity.setScopeDefinitionId(eventSubscriptionBuilder.getScopeDefinitionId());</span>
<span class="nc" id="L294">        subscriptionEntity.setScopeDefinitionKey(eventSubscriptionBuilder.getScopeDefinitionKey());</span>
<span class="nc" id="L295">        subscriptionEntity.setScopeType(eventSubscriptionBuilder.getScopeType());</span>
        
<span class="nc bnc" id="L297" title="All 2 branches missed.">        if (eventSubscriptionBuilder.getTenantId() != null) {</span>
<span class="nc" id="L298">            subscriptionEntity.setTenantId(eventSubscriptionBuilder.getTenantId());</span>
        }
        
<span class="nc" id="L301">        insert(subscriptionEntity);</span>
        
<span class="nc" id="L303">        return subscriptionEntity;</span>
    }
    
    protected MessageEventSubscriptionEntity insertMessageEvent(EventSubscriptionBuilder eventSubscriptionBuilder) {
<span class="nc" id="L307">        MessageEventSubscriptionEntity subscriptionEntity = createMessageEventSubscription();</span>
<span class="nc" id="L308">        subscriptionEntity.setExecutionId(eventSubscriptionBuilder.getExecutionId());</span>
<span class="nc" id="L309">        subscriptionEntity.setProcessInstanceId(eventSubscriptionBuilder.getProcessInstanceId());</span>
<span class="nc" id="L310">        subscriptionEntity.setEventName(eventSubscriptionBuilder.getEventName());</span>

<span class="nc" id="L312">        subscriptionEntity.setActivityId(eventSubscriptionBuilder.getActivityId());</span>
<span class="nc" id="L313">        subscriptionEntity.setProcessDefinitionId(eventSubscriptionBuilder.getProcessDefinitionId());</span>
<span class="nc" id="L314">        subscriptionEntity.setScopeDefinitionKey(eventSubscriptionBuilder.getScopeDefinitionKey());</span>
<span class="nc bnc" id="L315" title="All 2 branches missed.">        if (eventSubscriptionBuilder.getTenantId() != null) {</span>
<span class="nc" id="L316">            subscriptionEntity.setTenantId(eventSubscriptionBuilder.getTenantId());</span>
        }

<span class="nc" id="L319">        subscriptionEntity.setConfiguration(eventSubscriptionBuilder.getConfiguration());</span>

<span class="nc" id="L321">        insert(subscriptionEntity);</span>
        
<span class="nc" id="L323">        return subscriptionEntity;</span>
    }
    
    protected CompensateEventSubscriptionEntity insertCompensationEvent(EventSubscriptionBuilder eventSubscriptionBuilder) {
<span class="nc" id="L327">        CompensateEventSubscriptionEntity eventSubscription = createCompensateEventSubscription();</span>
<span class="nc" id="L328">        eventSubscription.setExecutionId(eventSubscriptionBuilder.getExecutionId());</span>
<span class="nc" id="L329">        eventSubscription.setProcessInstanceId(eventSubscriptionBuilder.getProcessInstanceId());</span>
<span class="nc" id="L330">        eventSubscription.setActivityId(eventSubscriptionBuilder.getActivityId());</span>
<span class="nc bnc" id="L331" title="All 2 branches missed.">        if (eventSubscriptionBuilder.getTenantId() != null) {</span>
<span class="nc" id="L332">            eventSubscription.setTenantId(eventSubscriptionBuilder.getTenantId());</span>
        }

<span class="nc" id="L335">        eventSubscription.setConfiguration(eventSubscriptionBuilder.getConfiguration());</span>

<span class="nc" id="L337">        insert(eventSubscription);</span>
<span class="nc" id="L338">        return eventSubscription;</span>
    }

    protected GenericEventSubscriptionEntity insertGenericEvent(EventSubscriptionBuilder eventSubscriptionBuilder) {
<span class="nc" id="L342">        GenericEventSubscriptionEntity eventSubscription = createGenericEventSubscription();</span>
<span class="nc" id="L343">        eventSubscription.setEventType(eventSubscriptionBuilder.getEventType());</span>
<span class="nc" id="L344">        eventSubscription.setEventName(eventSubscriptionBuilder.getEventName());</span>
<span class="nc" id="L345">        eventSubscription.setExecutionId(eventSubscriptionBuilder.getExecutionId());</span>
<span class="nc" id="L346">        eventSubscription.setProcessInstanceId(eventSubscriptionBuilder.getProcessInstanceId());</span>
<span class="nc" id="L347">        eventSubscription.setActivityId(eventSubscriptionBuilder.getActivityId());</span>
<span class="nc" id="L348">        eventSubscription.setProcessDefinitionId(eventSubscriptionBuilder.getProcessDefinitionId());</span>
<span class="nc" id="L349">        eventSubscription.setSubScopeId(eventSubscriptionBuilder.getSubScopeId());</span>
<span class="nc" id="L350">        eventSubscription.setScopeId(eventSubscriptionBuilder.getScopeId());</span>
<span class="nc" id="L351">        eventSubscription.setScopeDefinitionId(eventSubscriptionBuilder.getScopeDefinitionId());</span>
<span class="nc" id="L352">        eventSubscription.setScopeDefinitionKey(eventSubscriptionBuilder.getScopeDefinitionKey());</span>
<span class="nc" id="L353">        eventSubscription.setScopeType(eventSubscriptionBuilder.getScopeType());</span>

<span class="nc bnc" id="L355" title="All 2 branches missed.">        if (eventSubscriptionBuilder.getTenantId() != null) {</span>
<span class="nc" id="L356">            eventSubscription.setTenantId(eventSubscriptionBuilder.getTenantId());</span>
        }

<span class="nc" id="L359">        eventSubscription.setConfiguration(eventSubscriptionBuilder.getConfiguration());</span>

<span class="nc" id="L361">        insert(eventSubscription);</span>

<span class="nc" id="L363">        return eventSubscription;</span>
    }

    protected List&lt;SignalEventSubscriptionEntity&gt; toSignalEventSubscriptionEntityList(List&lt;EventSubscriptionEntity&gt; result) {
<span class="nc" id="L367">        List&lt;SignalEventSubscriptionEntity&gt; signalEventSubscriptionEntities = new ArrayList&lt;&gt;(result.size());</span>
<span class="nc bnc" id="L368" title="All 2 branches missed.">        for (EventSubscriptionEntity eventSubscriptionEntity : result) {</span>
<span class="nc" id="L369">            signalEventSubscriptionEntities.add((SignalEventSubscriptionEntity) eventSubscriptionEntity);</span>
<span class="nc" id="L370">        }</span>
<span class="nc" id="L371">        return signalEventSubscriptionEntities;</span>
    }

    protected List&lt;MessageEventSubscriptionEntity&gt; toMessageEventSubscriptionEntityList(List&lt;EventSubscriptionEntity&gt; result) {
<span class="nc" id="L375">        List&lt;MessageEventSubscriptionEntity&gt; messageEventSubscriptionEntities = new ArrayList&lt;&gt;(result.size());</span>
<span class="nc bnc" id="L376" title="All 2 branches missed.">        for (EventSubscriptionEntity eventSubscriptionEntity : result) {</span>
<span class="nc" id="L377">            messageEventSubscriptionEntities.add((MessageEventSubscriptionEntity) eventSubscriptionEntity);</span>
<span class="nc" id="L378">        }</span>
<span class="nc" id="L379">        return messageEventSubscriptionEntities;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>