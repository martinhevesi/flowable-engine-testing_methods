<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ProcessDbSchemaManager.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jacoco.exec</a> &gt; <a href="index.source.html" class="el_package">org.flowable.engine.impl.db</a> &gt; <span class="el_source">ProcessDbSchemaManager.java</span></div><h1>ProcessDbSchemaManager.java</h1><pre class="source lang-java linenums">/* Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.flowable.engine.impl.db;

import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.flowable.common.engine.api.FlowableException;
import org.flowable.common.engine.api.FlowableWrongDbException;
import org.flowable.common.engine.impl.FlowableVersions;
import org.flowable.common.engine.impl.db.AbstractSqlScriptBasedDbSchemaManager;
import org.flowable.common.engine.impl.db.DbSqlSession;
import org.flowable.common.engine.impl.db.SchemaManager;
import org.flowable.common.engine.impl.lock.LockManager;
import org.flowable.common.engine.impl.persistence.entity.PropertyEntity;
import org.flowable.common.engine.impl.persistence.entity.PropertyEntityImpl;
import org.flowable.engine.ProcessEngine;
import org.flowable.engine.impl.cfg.ProcessEngineConfigurationImpl;
import org.flowable.engine.impl.util.CommandContextUtil;

<span class="nc" id="L31">public class ProcessDbSchemaManager extends AbstractSqlScriptBasedDbSchemaManager {</span>
    
<span class="nc" id="L33">    protected static final Pattern CLEAN_VERSION_REGEX = Pattern.compile(&quot;\\d\\.\\d*&quot;);</span>

    protected static final String PROCESS_DB_SCHEMA_LOCK_NAME = &quot;processDbSchemaLock&quot;;
    
    @Override
    public void schemaCheckVersion() {
        try {
<span class="nc" id="L40">            String dbVersion = getDbVersion();</span>
<span class="nc bnc" id="L41" title="All 2 branches missed.">            if (!ProcessEngine.VERSION.equals(dbVersion)) {</span>
<span class="nc" id="L42">                throw new FlowableWrongDbException(ProcessEngine.VERSION, dbVersion);</span>
            }

<span class="nc" id="L45">            String errorMessage = null;</span>
<span class="nc bnc" id="L46" title="All 2 branches missed.">            if (!isEngineTablePresent()) {</span>
<span class="nc" id="L47">                errorMessage = addMissingComponent(errorMessage, &quot;engine&quot;);</span>
            }
<span class="nc bnc" id="L49" title="All 4 branches missed.">            if (CommandContextUtil.getDbSqlSession().getDbSqlSessionFactory().isDbHistoryUsed() &amp;&amp; !isHistoryTablePresent()) {</span>
<span class="nc" id="L50">                errorMessage = addMissingComponent(errorMessage, &quot;history&quot;);</span>
            }

<span class="nc bnc" id="L53" title="All 2 branches missed.">            if (errorMessage != null) {</span>
<span class="nc" id="L54">                throw new FlowableException(&quot;Flowable database problem: &quot; + errorMessage);</span>
            }

<span class="nc" id="L57">        } catch (Exception e) {</span>
<span class="nc bnc" id="L58" title="All 2 branches missed.">            if (isMissingTablesException(e)) {</span>
<span class="nc" id="L59">                throw new FlowableException(</span>
                        &quot;no flowable tables in db. set &lt;property name=\&quot;databaseSchemaUpdate\&quot; to value=\&quot;true\&quot; or value=\&quot;create-drop\&quot; (use create-drop for testing only!) in bean processEngineConfiguration in flowable.cfg.xml for automatic schema creation&quot;,
                        e);
            } else {
<span class="nc bnc" id="L63" title="All 2 branches missed.">                if (e instanceof RuntimeException) {</span>
<span class="nc" id="L64">                    throw (RuntimeException) e;</span>
                } else {
<span class="nc" id="L66">                    throw new FlowableException(&quot;couldn't get db schema version&quot;, e);</span>
                }
            }
<span class="nc" id="L69">        }</span>

<span class="nc" id="L71">        logger.debug(&quot;flowable db schema check successful&quot;);</span>
<span class="nc" id="L72">    }</span>

    protected String addMissingComponent(String missingComponents, String component) {
<span class="nc bnc" id="L75" title="All 2 branches missed.">        if (missingComponents == null) {</span>
<span class="nc" id="L76">            return &quot;Tables missing for component(s) &quot; + component;</span>
        }
<span class="nc" id="L78">        return missingComponents + &quot;, &quot; + component;</span>
    }

    protected String getDbVersion() {
<span class="nc" id="L82">        DbSqlSession dbSqlSession = CommandContextUtil.getDbSqlSession();</span>
<span class="nc" id="L83">        String selectSchemaVersionStatement = dbSqlSession.getDbSqlSessionFactory().mapStatement(&quot;org.flowable.common.engine.impl.persistence.entity.PropertyEntityImpl.selectDbSchemaVersion&quot;);</span>
<span class="nc" id="L84">        return (String) dbSqlSession.getSqlSession().selectOne(selectSchemaVersionStatement);</span>
    }
    
    @Override
    public void schemaCreate() {
        
        // The common schema manager is special and would handle its own locking mechanism
<span class="nc" id="L91">        getCommonSchemaManager().schemaCreate();</span>

<span class="nc" id="L93">        ProcessEngineConfigurationImpl processEngineConfiguration = getProcessEngineConfiguration();</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">        if (processEngineConfiguration.isUseLockForDatabaseSchemaUpdate()) {</span>
<span class="nc" id="L95">            LockManager lockManager = processEngineConfiguration.getManagementService().getLockManager(PROCESS_DB_SCHEMA_LOCK_NAME);</span>
<span class="nc" id="L96">            lockManager.waitForLockRunAndRelease(processEngineConfiguration.getSchemaLockWaitTime(), () -&gt; {</span>
<span class="nc" id="L97">                schemaCreateInLock();</span>
<span class="nc" id="L98">                return null;</span>
            });
<span class="nc" id="L100">        } else {</span>
<span class="nc" id="L101">            schemaCreateInLock();</span>
        }
<span class="nc" id="L103">    }</span>

    protected void schemaCreateInLock() {
<span class="nc" id="L106">        getIdentityLinkSchemaManager().schemaCreate();</span>
<span class="nc" id="L107">        getEntityLinkSchemaManager().schemaCreate();</span>
<span class="nc" id="L108">        getEventSubscriptionSchemaManager().schemaCreate();</span>
<span class="nc" id="L109">        getTaskSchemaManager().schemaCreate();</span>
<span class="nc" id="L110">        getVariableSchemaManager().schemaCreate();</span>
<span class="nc" id="L111">        getJobSchemaManager().schemaCreate();</span>
<span class="nc" id="L112">        getBatchSchemaManager().schemaCreate();</span>
        
<span class="nc bnc" id="L114" title="All 2 branches missed.">        if (isEngineTablePresent()) {</span>
<span class="nc" id="L115">            String dbVersion = getDbVersion();</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">            if (!ProcessEngine.VERSION.equals(dbVersion)) {</span>
<span class="nc" id="L117">                throw new FlowableWrongDbException(ProcessEngine.VERSION, dbVersion);</span>
            }
<span class="nc" id="L119">        } else {</span>
<span class="nc" id="L120">            dbSchemaCreateEngine();</span>
        }
        
<span class="nc bnc" id="L123" title="All 2 branches missed.">        if (CommandContextUtil.getDbSqlSession().getDbSqlSessionFactory().isDbHistoryUsed()) {</span>
<span class="nc" id="L124">            dbSchemaCreateHistory();</span>
        }
<span class="nc" id="L126">    }</span>

    protected void dbSchemaCreateHistory() {
<span class="nc" id="L129">        executeMandatorySchemaResource(&quot;create&quot;, &quot;history&quot;);</span>
<span class="nc" id="L130">    }</span>

    protected void dbSchemaCreateEngine() {
<span class="nc" id="L133">        executeMandatorySchemaResource(&quot;create&quot;, &quot;engine&quot;);</span>
<span class="nc" id="L134">    }</span>

    @Override
    public void schemaDrop() {
        
        try {
<span class="nc" id="L140">            executeMandatorySchemaResource(&quot;drop&quot;, &quot;engine&quot;);</span>
<span class="nc bnc" id="L141" title="All 2 branches missed.">            if (CommandContextUtil.getDbSqlSession().getDbSqlSessionFactory().isDbHistoryUsed()) {</span>
<span class="nc" id="L142">                executeMandatorySchemaResource(&quot;drop&quot;, &quot;history&quot;);</span>
            }
            
<span class="nc" id="L145">        } catch (Exception e) {</span>
<span class="nc" id="L146">            logger.info(&quot;Error dropping engine tables&quot;, e);</span>
<span class="nc" id="L147">        }</span>
        
        try {
<span class="nc" id="L150">            getBatchSchemaManager().schemaDrop();</span>
<span class="nc" id="L151">        } catch (Exception e) {</span>
<span class="nc" id="L152">            logger.info(&quot;Error dropping batch tables&quot;, e);</span>
<span class="nc" id="L153">        }</span>
        
        try {
<span class="nc" id="L156">            getJobSchemaManager().schemaDrop();</span>
<span class="nc" id="L157">        } catch (Exception e) {</span>
<span class="nc" id="L158">            logger.info(&quot;Error dropping job tables&quot;, e);</span>
<span class="nc" id="L159">        }</span>
     
        try {
<span class="nc" id="L162">            getVariableSchemaManager().schemaDrop();</span>
<span class="nc" id="L163">        } catch (Exception e) {</span>
<span class="nc" id="L164">            logger.info(&quot;Error dropping variable tables&quot;, e);</span>
<span class="nc" id="L165">        }</span>
        
        try {
<span class="nc" id="L168">            getTaskSchemaManager().schemaDrop();</span>
<span class="nc" id="L169">        } catch (Exception e) {</span>
<span class="nc" id="L170">            logger.info(&quot;Error dropping task tables&quot;, e);</span>
<span class="nc" id="L171">        }</span>
        
        try {
<span class="nc" id="L174">            getEventSubscriptionSchemaManager().schemaDrop();</span>
<span class="nc" id="L175">        } catch (Exception e) {</span>
<span class="nc" id="L176">            logger.info(&quot;Error dropping event subscription tables&quot;, e);</span>
<span class="nc" id="L177">        }</span>
        
        try {
<span class="nc" id="L180">            getEntityLinkSchemaManager().schemaDrop();</span>
<span class="nc" id="L181">        } catch (Exception e) {</span>
<span class="nc" id="L182">            logger.info(&quot;Error dropping entity link tables&quot;, e);</span>
<span class="nc" id="L183">        }</span>
        
        try {
<span class="nc" id="L186">            getIdentityLinkSchemaManager().schemaDrop();</span>
<span class="nc" id="L187">        } catch (Exception e) {</span>
<span class="nc" id="L188">            logger.info(&quot;Error dropping identity link tables&quot;, e);</span>
<span class="nc" id="L189">        }</span>
        
        try {
<span class="nc" id="L192">            getCommonSchemaManager().schemaDrop();</span>
<span class="nc" id="L193">        } catch (Exception e) {</span>
<span class="nc" id="L194">            logger.info(&quot;Error dropping common tables&quot;, e);</span>
<span class="nc" id="L195">        }</span>
<span class="nc" id="L196">    }</span>

    public void dbSchemaPrune() {
<span class="nc bnc" id="L199" title="All 4 branches missed.">        if (isHistoryTablePresent() &amp;&amp; !CommandContextUtil.getDbSqlSession().getDbSqlSessionFactory().isDbHistoryUsed()) {</span>
<span class="nc" id="L200">            executeMandatorySchemaResource(&quot;drop&quot;, &quot;history&quot;);</span>
        }
<span class="nc" id="L202">    }</span>

    @Override
    public String schemaUpdate() {
        
<span class="nc" id="L207">        PropertyEntity dbVersionProperty = null;</span>
<span class="nc" id="L208">        String dbVersion = null;</span>
<span class="nc" id="L209">        String feedback = null;</span>
<span class="nc" id="L210">        boolean isUpgradeNeeded = false;</span>
<span class="nc" id="L211">        int matchingVersionIndex = -1;</span>
<span class="nc" id="L212">        int version6120Index = FlowableVersions.getFlowableVersionIndexForDbVersion(FlowableVersions.LAST_V6_VERSION_BEFORE_SERVICES);</span>

<span class="nc" id="L214">        DbSqlSession dbSqlSession = CommandContextUtil.getDbSqlSession();</span>
<span class="nc" id="L215">        boolean isEngineTablePresent = isEngineTablePresent();</span>
<span class="nc bnc" id="L216" title="All 2 branches missed.">        if (isEngineTablePresent) {</span>
<span class="nc" id="L217">            dbVersionProperty = dbSqlSession.selectById(PropertyEntityImpl.class, &quot;schema.version&quot;);</span>
<span class="nc" id="L218">            dbVersion = dbVersionProperty.getValue();</span>
        }
        
        // The common schema manager is special and would handle its own locking mechanism
<span class="nc" id="L222">        getCommonSchemaManager().schemaUpdate(dbVersion);</span>

<span class="nc" id="L224">        ProcessEngineConfigurationImpl processEngineConfiguration = getProcessEngineConfiguration();</span>
        LockManager lockManager;
<span class="nc bnc" id="L226" title="All 2 branches missed.">        if (processEngineConfiguration.isUseLockForDatabaseSchemaUpdate()) {</span>
<span class="nc" id="L227">            lockManager = processEngineConfiguration.getManagementService().getLockManager(PROCESS_DB_SCHEMA_LOCK_NAME);</span>
<span class="nc" id="L228">            lockManager.waitForLock(processEngineConfiguration.getSchemaLockWaitTime());</span>
        } else {
<span class="nc" id="L230">            lockManager = null;</span>
        }

        try {
<span class="nc bnc" id="L234" title="All 2 branches missed.">            if (isEngineTablePresent) {</span>
<span class="nc" id="L235">                dbVersionProperty = dbSqlSession.selectById(PropertyEntityImpl.class, &quot;schema.version&quot;);</span>
<span class="nc" id="L236">                dbVersion = dbVersionProperty.getValue();</span>

<span class="nc" id="L238">                matchingVersionIndex = FlowableVersions.getFlowableVersionIndexForDbVersion(dbVersion);</span>
<span class="nc bnc" id="L239" title="All 2 branches missed.">                isUpgradeNeeded = (matchingVersionIndex != (FlowableVersions.FLOWABLE_VERSIONS.size() - 1));</span>
            }

<span class="nc" id="L242">            boolean isHistoryTablePresent = isHistoryTablePresent();</span>
<span class="nc bnc" id="L243" title="All 4 branches missed.">            if (isUpgradeNeeded &amp;&amp; matchingVersionIndex &lt; version6120Index) {</span>
<span class="nc" id="L244">                dbSchemaUpgradeUntil6120(&quot;engine&quot;, matchingVersionIndex, dbVersion);</span>

<span class="nc bnc" id="L246" title="All 2 branches missed.">                if (isHistoryTablePresent) {</span>
<span class="nc" id="L247">                    dbSchemaUpgradeUntil6120(&quot;history&quot;, matchingVersionIndex, dbVersion);</span>
                }
            }

<span class="nc" id="L251">            getIdentityLinkSchemaManager().schemaUpdate(dbVersion);</span>
<span class="nc" id="L252">            getEntityLinkSchemaManager().schemaUpdate(dbVersion);</span>
<span class="nc" id="L253">            getEventSubscriptionSchemaManager().schemaUpdate(dbVersion);</span>
<span class="nc" id="L254">            getTaskSchemaManager().schemaUpdate(dbVersion);</span>
<span class="nc" id="L255">            getVariableSchemaManager().schemaUpdate(dbVersion);</span>
<span class="nc" id="L256">            getJobSchemaManager().schemaUpdate(dbVersion);</span>
<span class="nc" id="L257">            getBatchSchemaManager().schemaUpdate(dbVersion);</span>

<span class="nc bnc" id="L259" title="All 2 branches missed.">            if (isUpgradeNeeded) {</span>
<span class="nc" id="L260">                dbVersionProperty.setValue(ProcessEngine.VERSION);</span>

                PropertyEntity dbHistoryProperty;
<span class="nc bnc" id="L263" title="All 2 branches missed.">                if (&quot;5.0&quot;.equals(dbVersion)) {</span>
<span class="nc" id="L264">                    dbHistoryProperty = CommandContextUtil.getPropertyEntityManager().create();</span>
<span class="nc" id="L265">                    dbHistoryProperty.setName(&quot;schema.history&quot;);</span>
<span class="nc" id="L266">                    dbHistoryProperty.setValue(&quot;create(5.0)&quot;);</span>
<span class="nc" id="L267">                    dbSqlSession.insert(dbHistoryProperty, processEngineConfiguration.getIdGenerator());</span>
                } else {
<span class="nc" id="L269">                    dbHistoryProperty = dbSqlSession.selectById(PropertyEntity.class, &quot;schema.history&quot;);</span>
                }

                // Set upgrade history
<span class="nc" id="L273">                String dbHistoryValue = &quot;upgrade(&quot; + dbVersion + &quot;-&gt;&quot; + ProcessEngine.VERSION + &quot;)&quot;;</span>
<span class="nc" id="L274">                dbHistoryProperty.setValue(dbHistoryValue);</span>

                // Engine upgrade
<span class="nc bnc" id="L277" title="All 2 branches missed.">                if (version6120Index &gt; matchingVersionIndex) {</span>
<span class="nc" id="L278">                    dbSchemaUpgrade(&quot;engine&quot;, version6120Index, dbVersion);</span>
                } else {
<span class="nc" id="L280">                    dbSchemaUpgrade(&quot;engine&quot;, matchingVersionIndex, dbVersion);</span>
                }

<span class="nc" id="L283">                feedback = &quot;upgraded Flowable from &quot; + dbVersion + &quot; to &quot; + ProcessEngine.VERSION;</span>

<span class="nc bnc" id="L285" title="All 2 branches missed.">            } else if (!isEngineTablePresent) {</span>
<span class="nc" id="L286">                dbSchemaCreateEngine();</span>
            }

<span class="nc bnc" id="L289" title="All 2 branches missed.">            if (isHistoryTablePresent) {</span>
<span class="nc bnc" id="L290" title="All 2 branches missed.">                if (isUpgradeNeeded) {</span>
<span class="nc bnc" id="L291" title="All 2 branches missed.">                    if (version6120Index &gt; matchingVersionIndex) {</span>
<span class="nc" id="L292">                        dbSchemaUpgrade(&quot;history&quot;, version6120Index, dbVersion);</span>
                    } else {
<span class="nc" id="L294">                        dbSchemaUpgrade(&quot;history&quot;, matchingVersionIndex, dbVersion);</span>
                    }
                }

<span class="nc bnc" id="L298" title="All 2 branches missed.">            } else if (dbSqlSession.getDbSqlSessionFactory().isDbHistoryUsed()) {</span>
<span class="nc" id="L299">                dbSchemaCreateHistory();</span>
            }

<span class="nc" id="L302">            return feedback;</span>
        } finally {
<span class="nc bnc" id="L304" title="All 2 branches missed.">            if (lockManager != null) {</span>
<span class="nc" id="L305">                lockManager.releaseLock();</span>
            }
        }

    }

    public boolean isEngineTablePresent() {
<span class="nc" id="L312">        return isTablePresent(&quot;ACT_RU_EXECUTION&quot;);</span>
    }

    public boolean isHistoryTablePresent() {
<span class="nc" id="L316">        return isTablePresent(&quot;ACT_HI_PROCINST&quot;);</span>
    }

    protected String getCleanVersion(String versionString) {
<span class="nc" id="L320">        Matcher matcher = CLEAN_VERSION_REGEX.matcher(versionString);</span>
<span class="nc bnc" id="L321" title="All 2 branches missed.">        if (!matcher.find()) {</span>
<span class="nc" id="L322">            throw new FlowableException(&quot;Illegal format for version: &quot; + versionString);</span>
        }

<span class="nc" id="L325">        String cleanString = matcher.group();</span>
        try {
<span class="nc" id="L327">            Double.parseDouble(cleanString); // try to parse it, to see if it is</span>
                                             // really a number
<span class="nc" id="L329">            return cleanString;</span>
<span class="nc" id="L330">        } catch (NumberFormatException nfe) {</span>
<span class="nc" id="L331">            throw new FlowableException(&quot;Illegal format for version: &quot; + versionString, nfe);</span>
        }
    }

    protected boolean isMissingTablesException(Exception e) {
<span class="nc" id="L336">        String exceptionMessage = e.getMessage();</span>
<span class="nc bnc" id="L337" title="All 2 branches missed.">        if (e.getMessage() != null) {</span>
            // Matches message returned from H2
<span class="nc bnc" id="L339" title="All 4 branches missed.">            if ((exceptionMessage.contains(&quot;Table&quot;)) &amp;&amp; (exceptionMessage.contains(&quot;not found&quot;))) {</span>
<span class="nc" id="L340">                return true;</span>
            }

            // Message returned from MySQL and Oracle
<span class="nc bnc" id="L344" title="All 6 branches missed.">            if ((exceptionMessage.contains(&quot;Table&quot;) || exceptionMessage.contains(&quot;table&quot;)) &amp;&amp; (exceptionMessage.contains(&quot;doesn't exist&quot;))) {</span>
<span class="nc" id="L345">                return true;</span>
            }

            // Message returned from Postgres
<span class="nc bnc" id="L349" title="All 6 branches missed.">            if ((exceptionMessage.contains(&quot;relation&quot;) || exceptionMessage.contains(&quot;table&quot;)) &amp;&amp; (exceptionMessage.contains(&quot;does not exist&quot;))) {</span>
<span class="nc" id="L350">                return true;</span>
            }
        }
<span class="nc" id="L353">        return false;</span>
    }

    public void performSchemaOperationsProcessEngineClose() {
<span class="nc" id="L357">        String databaseSchemaUpdate = CommandContextUtil.getProcessEngineConfiguration().getDatabaseSchemaUpdate();</span>
<span class="nc bnc" id="L358" title="All 2 branches missed.">        if (org.flowable.engine.ProcessEngineConfiguration.DB_SCHEMA_UPDATE_CREATE_DROP.equals(databaseSchemaUpdate)) {</span>
<span class="nc" id="L359">            schemaDrop();</span>
        }
<span class="nc" id="L361">    }</span>
    
    protected SchemaManager getCommonSchemaManager() {
<span class="nc" id="L364">        return CommandContextUtil.getProcessEngineConfiguration().getCommonSchemaManager();</span>
    }
    
    protected SchemaManager getIdentityLinkSchemaManager() {
<span class="nc" id="L368">        return CommandContextUtil.getProcessEngineConfiguration().getIdentityLinkSchemaManager();</span>
    }
    
    protected SchemaManager getEntityLinkSchemaManager() {
<span class="nc" id="L372">        return CommandContextUtil.getProcessEngineConfiguration().getEntityLinkSchemaManager();</span>
    }
    
    protected SchemaManager getEventSubscriptionSchemaManager() {
<span class="nc" id="L376">        return CommandContextUtil.getProcessEngineConfiguration().getEventSubscriptionSchemaManager();</span>
    }
    
    protected SchemaManager getVariableSchemaManager() {
<span class="nc" id="L380">        return CommandContextUtil.getProcessEngineConfiguration().getVariableSchemaManager();</span>
    }
    
    protected SchemaManager getTaskSchemaManager() {
<span class="nc" id="L384">        return CommandContextUtil.getProcessEngineConfiguration().getTaskSchemaManager();</span>
    }
    
    protected SchemaManager getJobSchemaManager() {
<span class="nc" id="L388">        return CommandContextUtil.getProcessEngineConfiguration().getJobSchemaManager();</span>
    }
    
    protected SchemaManager getBatchSchemaManager() {
<span class="nc" id="L392">        return CommandContextUtil.getProcessEngineConfiguration().getBatchSchemaManager();</span>
    }
    
    protected ProcessEngineConfigurationImpl getProcessEngineConfiguration() {
<span class="nc" id="L396">        return CommandContextUtil.getProcessEngineConfiguration();</span>
    }

    @Override
    protected String getResourcesRootDirectory() {
<span class="nc" id="L401">        return &quot;org/flowable/db/&quot;;</span>
    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>